<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>《深入浅出mysql》 - ZWiley的读书笔记</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="generator" content="mkdocs-1.0.4, mkdocs-gitbook-1.0.7">

<link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon">
<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta rel="next" href="" />
<link href="../../css/style.min.css" rel="stylesheet"> 
</head>

<body>
<div class="book">
<div class="book-summary">
<div id="book-search-input" role="search">
<input type="text" placeholder="Type to search" />
</div> <!-- end of book-search-input -->

<nav role="navigation">
<ul class="summary">
<li>
<a href="../.." target="_blank" class="custom-link">ZWiley的读书笔记</a>
</li>
<li class="divider"></li>
<li class="chapter" data-path="">
<a href="../..">简介</a>
<li class="header">C++</li>

<li>
<a href="../../基础语言/C++编译底层/" class="">《C++编译底层》</a>
</li>

<li>
<a href="../../基础语言/C++基础知识/" class="">《C++基础知识》</a>
</li>

<li>
<a href="../../基础语言/C++智能指针_异常机制_强制转换_RTTI/" class="">《C++智能指针》</a>
</li>

<li>
<a href="../../基础语言/C++面向对象/" class="">《C++面向对象》</a>
</li>

<li>
<a href="../../基础语言/STL/" class="">《C++ STL》</a>
</li>

<li class="header">计算机基础知识</li>

<li>
<a href="../../计算机基础知识/操作系统/" class="">《操作系统》</a>
</li>

<li>
<a href="../../计算机基础知识/计算机网络/" class="">《计算机网络》</a>
</li>

<li>
<a href="../../计算机基础知识/数据结构/" class="">《数据结构》</a>
</li>

<li>
<a href="../../计算机基础知识/海量数据处理/" class="">《海量数据处理》</a>
</li>

<li class="header">《基本手写代码》</li>

<li>
<a href="../../基本手写代码/插入排序.cpp" class="">《插入排序》</a>
</li>

<li>
<a href="../../基本手写代码/单例模式.cpp" class="">《单例模式》</a>
</li>

<li>
<a href="../../基本手写代码/堆排序.cpp" class="">《堆排序》</a>
</li>

<li>
<a href="../../基本手写代码/二分查找法.cpp" class="">《二分查找法》</a>
</li>

<li>
<a href="../../基本手写代码/非递归二叉树遍历.cpp" class="">《非递归二叉树遍历》</a>
</li>

<li>
<a href="../../基本手写代码/归并排序.cpp" class="">《归并排序》</a>
</li>

<li>
<a href="../../基本手写代码/快速排序.cpp" class="">《快速排序》</a>
</li>

<li>
<a href="../../基本手写代码/智能指针的设计与实现.cpp" class="">《智能指针的设计与实现》</a>
</li>

<li class="header">项目基础知识</li>

<li>
<a href="../../项目基础知识/Linux系统编程及基本命令/" class="">《Linux系统编程及基本命令》</a>
</li>

<li>
<a href="../../项目基础知识/MySQL/" class="">《MySQL》</a>
</li>

<li>
<a href="../../项目基础知识/Redis/" class="">《Redis》</a>
</li>

<li>
<a href="../../项目基础知识/Socket编程/" class="">《Socket编程》</a>
</li>

<li class="header">代码</li>

<li>
<a href="../../code/work_with_legacy_code/" class="">《Work with legacy code》</a>
</li>

<li>
<a href="../../code/代码大全/" class="">《代码大全》</a>
</li>

<li>
<a href="../../code/代码的未来/" class="">《代码的未来》</a>
</li>

<li>
<a href="../../code/基本功/" class="">《基本功》</a>
</li>

<li>
<a href="../../code/敏捷技能修炼/" class="">《敏捷技能修炼》</a>
</li>

<li>
<a href="../../code/程序员应该知道的97件事/" class="">《程序员应该知道的97件事》</a>
</li>

<li>
<a href="../../code/编写可读代码的艺术/" class="">《编写可读代码的艺术》</a>
</li>

<li>
<a href="../../code/编程匠艺/" class="">《编程匠艺》</a>
</li>

<li>
<a href="../../code/领域驱动设计/" class="">《领域驱动设计》</a>
</li>

<li>
<a href="../../code/codelife_不止代码/" class="">《codelife_不止代码》</a>
</li>

<li class="header">调试技术</li>

<li>
<a href="../../debug/软件调试修炼之道/book/" class="">《软件调试修炼之道》</a>
</li>

<li>
<a href="../../debug/Effective_Debugging/" class="">《Effective Debugging》</a>
</li>

<li class="header">数据库</li>

<li>
<a href="../getting_started_with_impala/" class="">《Getting started with impala》</a>
</li>

<li>
<a href="../mysql必知必会/" class="">《mysql必知必会》</a>
</li>

<li>
<a href="../mysql性能调优与架构实践/" class="">《mysql性能调优与架构实践》</a>
</li>

<li>
<a href="../Mysql技术内幕InnoDB存储引擎/" class="">《Mysql技术内幕InnoDB存储引擎》</a>
</li>

<li>
<a href="../redis实战/" class="">《Redis实战》</a>
</li>

<li>
<a href="../redis深度历险核心原理和应用实践/book/" class="">《Redis深度历险核心原理和应用实践》</a>
</li>

<li>
<a href="../redis设计与实现/" class="">《redis设计与实现》</a>
</li>

<li>
<a href="../七周七数据库/" class="">《七周七数据库》</a>
</li>

<li>
<a href="./" class="active">《深入浅出mysql》</a>
</li>

<li>
<a href="../高性能mysql第三版/" class="">《高性能mysql第三版》</a>
</li>

<li class="header">前端</li>

<li>
<a href="../../frontend/CSS_The_Missing_Manual/" class="">《CSS_The_Missing_Manual》</a>
</li>

<li>
<a href="../../frontend/reactjs_小书/" class="">《reactjs小书》</a>
</li>

<li>
<a href="../../frontend/es6标准入门/" class="">《ES6标准入门》</a>
</li>

<li>
<a href="../../frontend/jquery_pocket_reference/" class="">《jquery_pocket_reference》</a>
</li>

<li>
<a href="../../frontend/深入理解bootstrap/" class="">《深入理解bootstrap》</a>
</li>

<li class="header">golang</li>

<li>
<a href="../../golang/1_the_go_programming_lauguage/" class="">《1 The Go Programming Language》</a>
</li>

<li>
<a href="../../golang/2_the_go_programming_lauguage/" class="">《2 The Go Programming Language》</a>
</li>

<li>
<a href="../../golang/3_the_go_programming_lauguage/" class="">《3 The Go Programming Language》</a>
</li>

<li>
<a href="../../golang/build-web-application-with-golang/" class="">《Build Web Application With Golang》</a>
</li>

<li>
<a href="../../golang/go101/book/" class="">《Go101》</a>
</li>

<li>
<a href="../../golang/network-programming-with-go/book/" class="">《Network Programming with go》</a>
</li>

<li>
<a href="../../golang/building-microservices-with-go/book/" class="">《Building Microservices With Go》</a>
</li>

<li>
<a href="../../golang/building_restful_web_services_with_go/book/" class="">《Building Restful Web Services with Go》</a>
</li>

<li>
<a href="../../golang/concurrency-in-go/concurrency_in_go/" class="">《Concurrency In Go》</a>
</li>

<li>
<a href="../../golang/go_in_action(go语言实战)/" class="">《Go In Action(Go 实战)》</a>
</li>

<li>
<a href="../../golang/go语言学习笔记语言详解/" class="">《Go学习笔记语言详解》</a>
</li>

<li>
<a href="../../golang/go语言学习笔记源码剖析/" class="">《Go学习笔记源码剖析》</a>
</li>

<li>
<a href="../../golang/go语言编程/" class="">《go语言编程》</a>
</li>

<li>
<a href="../../golang/the_way_to_go/book/" class="">《go book》</a>
</li>

<li>
<a href="../../golang/advanced-go-programming-book/advanced-go-programming/" class="">《advanced-go-programming》</a>
</li>

<li>
<a href="../../golang/go-build-web-applications/module1/go-build-web-applications/go-build-web-applications/" class="">《go-build-web-applications》</a>
</li>

<li class="header">java</li>

<li>
<a href="../../java/java-basic-introduction/" class="">《java basic introduction》</a>
</li>

<li class="header">网络</li>

<li>
<a href="../../network/tcp_ip详解卷一/tcp_ip详解卷一/" class="">《TCP IP详解卷一》</a>
</li>

<li class="header">python</li>

<li>
<a href="../../python/fluent_python/" class="">《Fluent Python》</a>
</li>

<li>
<a href="../../python/Python_Microservices_Development/" class="">《Python Microservices Development》</a>
</li>

<li>
<a href="../../python/high_performance_python/" class="">《High Performance Python》</a>
</li>

<li>
<a href="../../python/python_网络编程/" class="">《Python网络编程》</a>
</li>

<li class="header">unix/linux</li>

<li>
<a href="../../unix_linux/Linux高性能服务器编程/Linux高性能服务器编程/" class="">《Linux高性能服务器编程》</a>
</li>

<li>
<a href="../../unix_linux/unix编程艺术/" class="">《unix编程艺术》</a>
</li>

<li>
<a href="../../unix_linux/unix网络编程卷一/" class="">《unix网络编程卷一》</a>
</li>

<li>
<a href="../../unix_linux/unix编程艺术/" class="">《unix编程艺术》</a>
</li>

<li>
<a href="../../unix_linux/APUE/environ/" class="">《APUE environ》</a>
</li>

<li>
<a href="../../unix_linux/APUE/fork/" class="">《APUE fork》</a>
</li>

<li>
<a href="../../unix_linux/APUE/gcc/" class="">《APUE gcc》</a>
</li>

<li>
<a href="../../unix_linux/APUE/IO/" class="">《APUE IO》</a>
</li>

<li>
<a href="../../unix_linux/APUE/IPC/" class="">《APUE IPC》</a>
</li>

<li>
<a href="../../unix_linux/APUE/makefile/" class="">《APUE makefile》</a>
</li>

<li>
<a href="../../unix_linux/APUE/wait/" class="">《APUE wait》</a>
</li>

<li>
<a href="../../unix_linux/APUE/动态库和静态库/" class="">《APUE 动态库和静态库》</a>
</li>

<li>
<a href="../../unix_linux/APUE/守护进程/" class="">《APUE 守护进程》</a>
</li>

<li>
<a href="../../unix_linux/APUE/文件权限/" class="">《APUE 文件权限》</a>
</li>

<li>
<a href="../../unix_linux/APUE/系统IO函数/" class="">《APUE 系统IO函数》</a>
</li>

<li>
<a href="../../unix_linux/APUE/信号/" class="">《APUE 信号》</a>
</li>

<li>
<a href="../../unix_linux/APUE/信号2/" class="">《APUE 信号2》</a>
</li>

<li>
<a href="../../unix_linux/APUE/线程/线程函数/" class="">《线程函数》</a>
</li>

<li>
<a href="../../unix_linux/APUE/线程/线程基础/" class="">《线程基础》</a>
</li>

<li>
<a href="../../unix_linux/APUE/线程/线程同步/" class="">《线程同步》</a>
</li>

<li class="header">分布式</li>

<li>
<a href="../../分布式/Kafka权威指南/" class="">《Kafka 权威指南》</a>
</li>

<li>
<a href="../../分布式/分布式框架原理与应用/" class="">《分布式框架原理与应用》</a>
</li>

<li>
<a href="../../分布式/大规模分布式存储系统/" class="">《大规模分布式存储系统》</a>
</li>

<li>
<a href="../../分布式/深入分布式缓存从原理到实践/" class="">《深入分布式缓存从原理到实践》</a>
</li>

<li class="header">搜索引擎</li>

<li>
<a href="../../搜索引擎/Elasticsearch实战/book/" class="">《Elasticsearch实战》</a>
</li>

<li class="header">容器</li>

<li>
<a href="../../devops/玩转Kubernets-CloudMan/" class="">《玩转Kubernets》</a>
</li>

<li>
<a href="../../devops/第一本docker书/" class="">《第一本docker书》</a>
</li>

<li class="header">开发工具</li>

<li>
<a href="../../开发工具/practical_vim/practical_vim/" class="">《Practical Vim》</a>
</li>

<li>
<a href="../../开发工具/vim8文本处理实战/vim8文本处理实战/" class="">《Vim8文本处理实战》</a>
</li>

<li>
<a href="../../开发工具/learn_vim_the_hard_way/" class="">《Learn vim scrpt the hard way》</a>
</li>

<li>
<a href="../../开发工具/pro_git/" class="">《Pro Git》</a>
</li>

<li>
<a href="../../开发工具/Mastering_vim/" class="">《Mastering Vim》</a>
</li>

<li>
<a href="../../开发工具/mastering_vim_quickly/" class="">《Mastering Vim Quickly》</a>
</li>

<li class="header">思维</li>

<li>
<a href="../../思维认知/专注力_化繁为简的惊人力量/" class="">《专注力》</a>
</li>

<li>
<a href="../../思维认知/为什么精英这样用脑不会累/" class="">《为什么精英这样用脑不会累》</a>
</li>

<li>
<a href="../../思维认知/刻意练习/" class="">《刻意练习》</a>
</li>

<li>
<a href="../../思维认知/如何想到又做到/" class="">《如何想到又做到》</a>
</li>

<li>
<a href="../../思维认知/学习之道/" class="">《学习之道》</a>
</li>

<li>
<a href="../../思维认知/学习力/" class="">《学习力》</a>
</li>

<li>
<a href="../../思维认知/批判性思维工具/" class="">《批判性思维工具》</a>
</li>

<li>
<a href="../../思维认知/程序员的思维修炼(开发认知潜能的九堂课)/" class="">《程序员的思维修炼》</a>
</li>

<li>
<a href="../../思维认知/认知天性/" class="">《认知天性》</a>
</li>

<li>
<a href="../../思维认知/超效率手册/" class="">《超效率手册》</a>
</li>

<li>
<a href="../../思维认知/如何高效记忆/" class="">《如何高效记忆》</a>
</li>

<li>
<a href="../../思维认知/科学学习/" class="">《科学学习》</a>
</li>

<li>
<a href="../../思维认知/高效程序员的45个习惯/" class="">《高效程序员的45个习惯》</a>
</li>

<li class="header">源码</li>

<li>
<a href="../../源码阅读_sourcecode/" class="">《源码阅读》</a>
</li>

<li class="header">网站架构微服务</li>

<li>
<a href="../../网站架构微服务/microservices_patterns_微服务架构设计模式/book/" class="">《微服务架构设计模式》</a>
</li>

<li>
<a href="../../网站架构微服务/从0开始学架构/从0开始学架构/" class="">《从0开始学架构》</a>
</li>

<li>
<a href="../../网站架构微服务/web_scalavility_for_startup_engineers/" class="">《web scalavility for startup engineers》</a>
</li>

<li>
<a href="../../网站架构微服务/design_data_instensive_application/" class="">《design_data_instensive_application》</a>
</li>

<li>
<a href="../../网站架构微服务/clean_architecture/" class="">《clean_architecture》</a>
</li>

<li>
<a href="../../网站架构微服务/微服务设计/" class="">《微服务设计》</a>
</li>

<li>
<a href="../../网站架构微服务/2_design_data_instensive_application/" class="">《2_design_data_instensive_application》</a>
</li>

<li>
<a href="../../网站架构微服务/3_design_data_instensive_application/" class="">《3_design_data_instensive_application》</a>
</li>

<li class="header">软件工程/项目管理</li>

<li>
<a href="../../软件工程_项目管理/人月神话/" class="">《人月神话》</a>
</li>

<li>
<a href="../../软件工程_项目管理/代码之殇/" class="">《代码之殇》</a>
</li>

<li>
<a href="../../软件工程_项目管理/解析极限编程-拥抱变化/" class="">《解析极限编程》</a>
</li>

<li>
<a href="../../软件工程_项目管理/项目管理修炼之道/" class="">《项目管理修炼之道》</a>
</li>

<li>
<a href="../../软件工程_项目管理/修改软件的艺术/" class="">《修改软件的艺术》</a>
</li>

<li class="header">运维</li>

<li>
<a href="../../运维/linux集群和自动化运维/" class="">《linux集群和自动化运维》</a>
</li>

<li>
<a href="../../运维/python自动化运维/" class="">《python自动化运维》</a>
</li>

<li class="header">金融理财</li>

<li>
<a href="../../金融理财/定投十年/" class="">《定投十年》</a>
</li>

<li>
<a href="../../金融理财/穷查理宝典/" class="">《穷查理宝典》</a>
</li>

<li class="header">写作</li>

<li>
<a href="../../写作/刷屏文案写作技巧/" class="">《刷屏文案写作技巧》</a>
</li>

<li class="header">互联网</li>

<li>
<a href="../../互联网/我的互联网方法论-周鸿祎/" class="">《我的互联网方法论-周鸿祎》</a>
</li>

<li>
<a href="../../互联网/用户思维/" class="">《用户思维》</a>
</li>

<li class="header">区块链</li>

<li>
<a href="../../区块链/区块链技术指南(blockchain_guide)/" class="">《区块链技术指南》</a>
</li>

<li class="header">技术演讲</li>

<li>
<a href="../../lecture/Gopher/哔哩哔哩的go微服务实战/note/" class="">《哔哩哔哩的go微服务实战》</a>
</li>

<li>
<a href="../../lecture/Gopher/Go_Error/go业务基础库之Error&Context/" class="">《go业务基础库之Error&Context》</a>
</li>

<li>
<a href="../../lecture/Gopher/Go同步和并发设计模式/note/" class="">《Go同步和并发设计模式》</a>
</li>

<li>
<a href="../../lecture/技术演讲/左耳朵耗子-我这技术二十年/" class="">《左耳朵耗子-我这技术二十年》</a>
</li>

<li class="header">职场</li>

<li>
<a href="../../career/give_and_take/" class="">《give and take》</a>
</li>

<li>
<a href="../../career/the_effective_engineer/" class="">《the_effective_engineer》</a>
</li>

<li>
<a href="../../career/光速成长/" class="">《光速成长》</a>
</li>

<li>
<a href="../../career/向上管理/" class="">《向上管理》</a>
</li>

<li>
<a href="../../career/成功动机与目标/" class="">《成功动机与目标》</a>
</li>

<li>
<a href="../../career/番茄工作法/" class="">《番茄工作法》</a>
</li>

<li>
<a href="../../career/聆听沟通学/" class="">《聆听沟通学》</a>
</li>

<li>
<a href="../../career/知乎职人觉醒/" class="">《知乎职人觉醒》</a>
</li>

<li>
<a href="../../career/知识变现/" class="">《知识变现》</a>
</li>

<li>
<a href="../../career/聆听沟通学/" class="">《聆听沟通学》</a>
</li>

<li>
<a href="../../career/职场动物进化手册/" class="">《职场动物进化手册》</a>
</li>

<li>
<a href="../../career/职场解释系/" class="">《职场解释系》</a>
</li>

<li>
<a href="../../career/请停止无效努力/" class="">《请停止无效努力》</a>
</li>

<li>
<a href="../../career/软技能/" class="">《软技能》</a>
</li>

<li>
<a href="../../career/高效15法则/" class="">《高效15法则》</a>
</li>

<li>
<a href="../../career/高效清单工作法/" class="">《高效清单工作法》</a>
</li>

<li>
<a href="../../career/程序员的自我修养/" class="">《程序员的自我修养》</a>
</li>

<li class="header">心理学</li>

<li>
<a href="../../psychology/一切都是童年的错吗/" class="">《一切都是童年的错吗》</a>
</li>

<li>
<a href="../../psychology/亲密关系/" class="">《亲密关系》</a>
</li>

<li>
<a href="../../psychology/情商/" class="">《情商》</a>
</li>

<li>
<a href="../../psychology/拖延心理学/" class="">《拖延心理学》</a>
</li>

<li>
<a href="../../psychology/积极心理学/" class="">《积极心理学》</a>
</li>

<li>
<a href="../../psychology/自控力/" class="">《自控力》</a>
</li>

<li>
<a href="../../psychology/自控力-和压力做朋友/" class="">《自控力:和压力做朋友》</a>
</li>

<li>
<a href="../../psychology/活出最乐观的自己/" class="">《活出最乐观的自己》</a>
</li>

<li>
<a href="../../psychology/改变心理学的40项研究/" class="">《改变心理学的40项研究》</a>
</li>

<li>
<a href="../../psychology/超越自卑/" class="">《超越自卑》</a>
</li>

<li>
<a href="../../psychology/反脆弱/" class="">《反脆弱》</a>
</li>

<li class="header">创业</li>

<li>
<a href="../../startup/hello_startup/" class="">《Hello Startup》</a>
</li>

<li>
<a href="../../startup/斯坦福公开课-如何创业/" class="">《斯坦福公开课如何创业》</a>
</li>

<li>
<a href="../../startup/运营其实很简单/" class="">《运营其实很简单》</a>
</li>

<li class="divider"></li>



<li><a href="http://www.mkdocs.org">
Published with MkDocs
</a></li>

<li><a href="https://github.com/GitbookIO/theme-default">
Theme by GitBook
</a></li>
</ul>

</nav>

</div> <!-- end of book-summary -->

<div class="book-body">
<div class="body-inner">
<div class="book-header" role="navigation">

<!-- Title -->
<h1>
<i class="fa fa-circle-o-notch fa-spin"></i>
<a href="." ></a>
</h1>

</div> <!-- end of book-header -->

<div class="page-wrapper" tabindex="-1" role="main">
<div class="page-inner">
<div id="book-search-results">
<div class="search-noresults">

<section class="normal markdown-section">



<p>最近看了一本小书，网易技术部的《深入浅出MySQL数据库开发、优化与管理维护》，算是回顾一下mysql基础知识。数据库一直是笔者比较薄弱的地方，结合自己的使用经验(python+sqlalchemy)等做个记录，笔者比较喜欢使用ORM，一直感觉拼sql是一件比较痛苦的事情(主要是不擅长sql)，以前维护项的目中也遇到过一些数据库的坑，比如编码问题，浮点数精度损失等，防止以后重复踩坑。</p>
<h2 id="1">1章：使用帮助</h2>
<p>使用mysql内置的帮助命令</p>
<ul>
<li><code>msyql&gt; ? data types</code> : 查看数据类型</li>
<li><code>mysql&gt; ? int</code></li>
<li><code>mysql&gt; ? create table</code></li>
</ul>
<h2 id="2">2章：表类型（存储引擎）的选择</h2>
<p>最常用的两种引擎:</p>
<ol>
<li>
<p>Myisam是Mysql的默认存储引擎,当create创建新表时,未指定新表的存储引擎时,默认使用Myisam。 每个MyISAM 在磁盘上存储成三个文件。文件名都和表名相同,扩展名分别是 .frm (存储表定义) 、.MYD (MYData,存储数据)、.MYI (MYIndex,存储索引)。数据文件和 索引文件可以放置在不同的目录,平均分布io,获得更快的速度。</p>
</li>
<li>
<p>InnoDB 存储引擎提供了具有提交、回滚和崩溃恢复能力的事务安全。但是对比 Myisam 的存储引擎,InnoDB 写的处理效率差一些并且会占用更多的磁盘空间以保留数据和索引。</p>
</li>
</ol>
<p>常用环境:</p>
<ol>
<li>MyISAM: 默认的 MySQL 插件式存储引擎, 它是在 Web、 数据仓储和其他应用环境下最常
使用的存储引擎之一</li>
<li>InnoDB:用于事务处理应用程序,具有众多特性,包括 ACID 事务支持。</li>
</ol>
<h2 id="3">3章：选择合适的数据类型</h2>
<p>首先选择合适的存储引擎，根据指定的存储引擎确定合适的数据类型。</p>
<ul>
<li>MyISAM: 最好使用固定长度的数据列代替可变长度的数据列。</li>
<li>InnoDB: 建议使用varchar</li>
</ul>
<p>需要注意的一些数据类型：</p>
<ul>
<li>char与varchar: 保存和检索方式不同，最大长度和是否尾部空格被保留也不同。char固定长度，长度不够用空格填充，获取时如果没有设置 PAD_CHAR_TO_FULL_LENGTH默认去除尾部空格。
varchar变长字符串，检索时尾部空格会被保留。注意查询时候不区分大小写，如果用sqlalchemy区分大小写不要用func.binary函数。</li>
</ul>
<ul>
<li>text和blob: text和blob执行大量的更新或者删除的时候会留下很大『空洞』，建议定期用OPTIMIZE TABLE功能对这类表碎片整理。避免检索大型的blob或text值 。把text和blob列分离到单独的表中。</li>
</ul>
<ul>
<li>浮点数float与定点数decimal: 注意几个点：
    - 1.浮点数虽然能表示更大的数据范围，但是有误差问题。
    - 2.对货币等精度敏感的问题，应使用定点数存储。之前项目踩过坑，结果不得不用放大和缩小倍数的方法解决，比较ugly。
    - 3.编程如果遇到浮点数，注意误差问题，尽量避免浮点数比较（比较浮点数需要作差小于一个特定精度），python3.5中可以这么比较：<code>float_eq = partial(math.isclose, rel_tol=1e-09, abs_tol=0.0)</code>
    - 4.注意浮点数中一些特殊值的处理。</li>
</ul>
<h2 id="4">4章：字符集</h2>
<p>一开始要选择合适的字符集，否则后期更换代价很高。python2中字符集就是个老大难问题，困然很多新手。之前维护过的项目使用了msyql默认的latin1字符集，导致每次写入的时候都要对字符串手动encode成utf8。最近用python3.5+flask做项目直接使用utf8，再也没碰到过编码问题：</p>
<ul>
<li>创建数据库使用utf8，CREATE DATABASE IF NOT EXISTS my_db default charset utf8 COLLATE utf8_general_ci;</li>
<li>sqlalchemy连接url使用mysql://root:root@127.0.0.1:3306/my_db?charset=utf8。不用担心乱码问题了</li>
</ul>
<h2 id="5">5章：索引的设计和使用</h2>
<p>所有mysql列类型都可以被索引，对相关列使用索引是提高select操作性能的最佳途径。索引设计的原则:
- 1.搜索的索引列，不一定是所要选择的列。最适合的索引的列是出现在where子句中的列，或连接子句中指定的列，而不是出现在select关键字之后的选择列表中的列。
- 2.使用唯一索引。对于唯一值的列，索引效果较好，而有多个重复值的列，索引效果差。
- 3.使用短索引。如果对字符串列进行索引，应指定一个前缀长度，只要有可能就应该这样做。
- 4.利用最左前缀。在创建一个n列索引时，实际上创建了mysql可利用的n个索引。多列索引可以起到几个索引的作用，因为可利用索引中的最左边的列集来匹配行，这样的列集成为最左前缀。
- 5.不要过度索引。索引会浪费磁盘空间，降低写入性能。
- 6.考虑在列上进行的比较类型。</p>
<h2 id="6">6章：锁机制和事务控制</h2>
<p>InnoDB引擎提提供行级锁，支持共享锁和排他锁两种锁定模式，以及四种不同的隔离级别。mysql通过AUTOCOMIT, START TRANSACTIONS, COMMIT和ROLLBACK等语句支持本地事务。</p>
<h2 id="7sql">7章：SQL中的安全问题</h2>
<ul>
<li>SQL注入：利用某些数据库的外部接口把用户数据插入到实际的数据库操作语音（sql）中，从而达到入侵数据库甚至操作系统的目的。产生原因主要是因为程序堆用户输入的数据没有进行严格的过滤，导致非法数据库查询语句的执行，防范措施：
    - prepareStatement = Bind-variable，不要使用拼接的sql
    - 使用应用程序提供的转换函数
    - 自定义函数校验（表单校验等）</li>
</ul>
<h2 id="8sql-mode">8章：SQL Mode及相关问题</h2>
<p>更改默认的mysql执行模式，比如严格模式下列的插入或者更新不正确时mysql会给出错误，并放弃操作。<code>set session sql_mode='STRICT_TRANS_TABLES'</code>。设置sql_mode需要应用人员权衡各种得失，做一个合适的选择。</p>
<h2 id="9sql">9章：常用SQL技巧</h2>
<ul>
<li>检索包含最大/最小值的行：MAX([DISTINCE] expr), MIN([DISTINCE] expr)</li>
<li>巧用rand()/rand(n)提取随机行</li>
<li>利用group by和with rollup子句做统计</li>
<li>用bit group functions做统计</li>
</ul>
<h2 id="10">10章：其他需要注意的问题</h2>
<ul>
<li>数据库名、表名大小写问题：不同平台和系统，是否区分大小写是不同的。建议就是始终统一使用小写名。</li>
<li>使用外键需要注意的地方：mysql中InnoDB支持对外部关键字约束条件的检查。</li>
</ul>
<h2 id="11sql">11章：SQL优化</h2>
<h4 id="sql">优化SQL的一般步骤：</h4>
<ul>
<li>1.使用show status和应用特点了解各种SQL的执行频率，了解各种SQL大致的执行比例。比如InnoDB的的参数Innode_rows_read查询返回的行数，Innodb_rows_inserted执行insert插入的行数，Innodb_rows_updated更新的行数。还有一下几个参数：Connections试图连接mysql服务器嗯出书，Uptime服务器的工作时间，Slow_queries慢查询的次数。</li>
<li>2.定位执行效率低的SQL语句。两种方式：一种是通过慢查询日志定位执行效率低的语句,使用--log-slow-queries[=file_name]选项启动时，mysqld写一个包含所有执行时间超过long_query_time秒的SQL语句的日志文件。另一种是show processlist查看当前mysql在进行的线程，包括线程的状态，所否锁表等，可以实时查看SQL执行情况，同时对一些锁表操作进行优化。</li>
<li>3.通过EXPLAIN分析低效SQL的执行计划：explain可以知道什么时候必须为表假如索引以得到一个使用索引来寻找记录的更快的SELECT，以下是EXPLAIN执行后得到的结果说明：
    - select_type: select类型
    - table: 输出结果集的表
    - type: 表示表的连接类型。当表中仅有一行是type的值为system是最佳的连接类型；当select操作中使用索引进行表连接时type值为ref；当select的表连接没有使用索引时，经常看到type的值为ALL，表示对该表进行了全表扫描，这时需要考虑通过创建索引提高表连接效率。
    - possible_keys: 表示查询时，可以使用的索引列。
    - key： 表示使用的索引
    - key_len: 索引长度
    - rows: 扫描范围
    - Extra: 执行情况的说明和描述</li>
</ul>
<ul>
<li>4.确定问题，并采取相应优化措施。</li>
</ul>
<h4 id="_1">索引问题</h4>
<ul>
<li>索引的存储分类: myisam表的数据文件和索引文件自动分开，innodb的数据和索引放在同一个表空间里面。myisam和innodb的索引存储类型都是btree</li>
</ul>
<ul>
<li>Mysql如何使用索引: 索引用于快速查找某个列中特定值的行。查询要使用索引最主要的条件是要在查询条件中使用索引关键子，如果是多列索引，那么只有查询条件中使用了多列关键字最左边的前缀时，才可以使用索引，否则将不能使用索引。</li>
</ul>
<ul>
<li>查看索引的使用情况：Handler_read_key的值代表一个行被索引次数，值低表示索引不被经常使用。Handler_read_rnd_next值高意味着查询运行低效，应该建立索引补救。<code>show status like 'Handler_read%';</code></li>
</ul>
<h4 id="_2">两个简单实用的优化方法</h4>
<ul>
<li>定期分析表：ANALYZE TABLE, CHECK TABLE, CHECKSUM TABLE</li>
<li>使用OPTIMIZE table;</li>
</ul>
<h4 id="_3">从客户端（代码端）角度优化</h4>
<ul>
<li>使用持久的连接数据库以避免连接开销。代码中我们一般使用连接池</li>
<li>检查所有的插叙确实使用了必要的索引。</li>
<li>避免在频繁更新的表上执行复杂的select查询，以避免与锁表有关的由于读，写冲突发生的问题。</li>
<li>充分利用默认值，只有插入值不同于默认值才明确插入值。减少mysql需要做的语法分析从而提高插入速度。</li>
<li>读写分离提高性能</li>
<li>表字段尽量不用自增长变量，防止高并发情况下该字段自增影响效率，推荐通过应用实现字段的自增。</li>
</ul>
<h2 id="12">12章: 优化数据库对象</h2>
<ul>
<li>优化表的数据类型：PROCEDURE ANALYZE()对当前表类型的判断提出优化建议。实际可以通过统计信息结合应用实际优化。</li>
<li>通过拆分，提高表的访问效率：这里拆分主要是针对Myisam类型的表。
    - 纵向拆分：按照应用访问的频度，将表中经常访问的字段和不经常访问的字段拆分成两个表，经常访问的字段尽量是定长的。
    - 横向拆分：按照应用情况，有目的地将数据横向拆分成几个表或者通过分区分到多个分区中，这样可以有效避免Myisam表的读取和更新导致的锁问题。</li>
</ul>
<ul>
<li>逆规范化：规范化设计强调独立性，数据尽可能少冗余，更多冗余意味着占用更多物理空间，同事也对数据维护和一致性检查带来问题。适当冗余可以减少多表访问，查询效率明显提高，这种情况可以考虑适当通过冗余提高效率。</li>
<li>使用冗余统计表：使用create temporary table做统计分析</li>
<li>选择更合适的表类型：1.如果应用出现比较严重的锁冲突，请考虑是否刻意更改存储引擎到InnoDB,行锁机制可以有效减少锁冲突出现。2.如果应用查询操作很多，且对事务完整性要求不严格，可以考虑使用Myisam。</li>
</ul>
<h2 id="13">13章：锁问题</h2>
<ul>
<li>获取锁的等待情况：table_locks_waited和table_locks_immediate状态变量来分析系统上的表锁定争夺。检查Innode_row_lock分析行锁的争夺情况。</li>
</ul>
<h2 id="14mysql-server">14章：优化Mysql Server</h2>
<h4 id="mysql-server">查看Mysql Server当前参数</h4>
<ul>
<li>查看服务器参数默认值：<code>mysqld --verbose --help</code></li>
<li>查看服务器参数实际值：<code>shell&gt; mysqladmin variables</code> or <code>mysql&gt; SHOW VARIABLES</code></li>
<li>查看服务器运行状态值：<code>mysqladmin extended-status</code> or <code>mysql&gt;SHOW STATUS</code></li>
</ul>
<h4 id="mysql">影响Mysql性能的重要参数</h4>
<ul>
<li>key_buffer_size: 键缓存</li>
<li>table_cache: 数据库中打开的缓存数量</li>
<li>innode_buffer_pool_size: 缓存InnoDB数据和索引的内存缓冲区的大小</li>
<li>innodb_flush_log_at_trx_commit: 推荐设成1，在每个事务提交时，日志缓冲被写到日志文件，对日志文件做到磁盘操作的刷新。</li>
</ul>
<h2 id="15io">15章：I/O问题</h2>
<p>磁盘搜索是巨大的性能瓶颈。
- 使用磁盘阵列或虚拟文件卷分布I/O
- 使用Symbolic Links分布I/O</p>
<h2 id="16">16章：应用优化</h2>
<ul>
<li>使用连接池：建立连接代价比较高，通过建立连接池提高访问性能。</li>
<li>减少对Mysql的访问：1.避免对同意数据重复检索。2使用mysql query cache</li>
<li>增加cache层</li>
<li>负载均衡：1.利用mysql复制分流查询操作。2分布式数据库架构</li>
</ul>


</section>
</div> <!-- end of search-noresults -->
<div class="search-results">
<div class="has-results">

<h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
<ul class="search-results-list"></ul>

</div> <!-- end of has-results -->
<div class="no-results">

<h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>

</div> <!-- end of no-results -->
</div> <!-- end of search-results -->
</div> <!-- end of book-search-results -->

</div> <!-- end of page-inner -->
</div> <!-- end of page-wrapper -->

</div> <!-- end of body-inner -->

</div> <!-- end of book-body -->
<script src="../../js/main.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="../../search/main.js"></script>
<script src="../../js/gitbook.min.js"></script>
<script src="../../js/theme.min.js"></script>
</body>
</html>