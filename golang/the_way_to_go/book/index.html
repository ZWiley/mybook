<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>go book - ZWiley的读书笔记</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../../css/theme.css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "go book";
    var mkdocs_page_input_path = "golang\\the_way_to_go\\book.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> ZWiley的读书笔记</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../..">简介</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">C++</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%9F%BA%E7%A1%80%E8%AF%AD%E8%A8%80/C%2B%2B%E7%BC%96%E8%AF%91%E5%BA%95%E5%B1%82/">C++编译底层</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%9F%BA%E7%A1%80%E8%AF%AD%E8%A8%80/C%2B%2B%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">C++基础知识</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%9F%BA%E7%A1%80%E8%AF%AD%E8%A8%80/C%2B%2B%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88_%E5%BC%82%E5%B8%B8%E6%9C%BA%E5%88%B6_%E5%BC%BA%E5%88%B6%E8%BD%AC%E6%8D%A2_RTTI/">C++智能指针</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%9F%BA%E7%A1%80%E8%AF%AD%E8%A8%80/C%2B%2B%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">C++面向对象</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%9F%BA%E7%A1%80%E8%AF%AD%E8%A8%80/STL/">C++ STL</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">计算机基础知识</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/">海量数据处理</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">基本手写代码</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%9F%BA%E6%9C%AC%E6%89%8B%E5%86%99%E4%BB%A3%E7%A0%81/%E5%9F%BA%E6%9C%AC%E6%89%8B%E5%86%99%E4%BB%A3%E7%A0%81%E9%A2%98%E7%9B%AE/">基本手写代码题目</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">项目基础知识</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E9%A1%B9%E7%9B%AE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/Linux%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B%E5%8F%8A%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/">Linux系统编程及基本命令</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E9%A1%B9%E7%9B%AE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/MySQL/">MySQL</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E9%A1%B9%E7%9B%AE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/Redis/">Redis</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E9%A1%B9%E7%9B%AE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/Socket%E7%BC%96%E7%A8%8B/">Socket编程</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">webserver项目</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/0%20%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0/">0 项目概述</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/1%20%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E6%9C%BA%E5%88%B6%E5%B0%81%E8%A3%85%E7%B1%BB/">1 线程同步机制封装类</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/2%20%E5%8D%8A%E5%90%8C%E6%AD%A5%E5%8D%8A%E5%8F%8D%E5%BA%94%E5%A0%86%E7%BA%BF%E7%A8%8B%E6%B1%A0%EF%BC%88%E4%B8%8A%EF%BC%89/">2 半同步半反应堆线程池（上）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/3%20%E5%8D%8A%E5%90%8C%E6%AD%A5%E5%8D%8A%E5%8F%8D%E5%BA%94%E5%A0%86%E7%BA%BF%E7%A8%8B%E6%B1%A0%EF%BC%88%E4%B8%8B%EF%BC%89/">3 半同步半反应堆线程池（下）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/4%20http%E8%BF%9E%E6%8E%A5%E5%A4%84%E7%90%86%EF%BC%88%E4%B8%8A%EF%BC%89/">4 http连接处理（上）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/5%20http%E8%BF%9E%E6%8E%A5%E5%A4%84%E7%90%86%EF%BC%88%E4%B8%AD%EF%BC%89/">5 http连接处理（中）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/6%20http%E8%BF%9E%E6%8E%A5%E5%A4%84%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/">6 http连接处理（下）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/7%20%E5%AE%9A%E6%97%B6%E5%99%A8%E5%A4%84%E7%90%86%E9%9D%9E%E6%B4%BB%E5%8A%A8%E8%BF%9E%E6%8E%A5%EF%BC%88%E4%B8%8A%EF%BC%89/">7 定时器处理非活动连接（上）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/8%20%E5%AE%9A%E6%97%B6%E5%99%A8%E5%A4%84%E7%90%86%E9%9D%9E%E6%B4%BB%E5%8A%A8%E8%BF%9E%E6%8E%A5%EF%BC%88%E4%B8%8B%EF%BC%89/">8 定时器处理非活动连接（下）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/9%20%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%8A%EF%BC%89/">9 日志系统（上）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/10%20%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%8B%EF%BC%89/">10 日志系统（下）</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/11%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/">11 数据库连接池</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../webserver/12%20%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/">12 常见问题</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">代码</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/work_with_legacy_code/">Work with legacy code</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E4%BB%A3%E7%A0%81%E5%A4%A7%E5%85%A8/">代码大全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9C%AA%E6%9D%A5/">代码的未来</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E5%9F%BA%E6%9C%AC%E5%8A%9F/">基本功</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E6%95%8F%E6%8D%B7%E6%8A%80%E8%83%BD%E4%BF%AE%E7%82%BC/">敏捷技能修炼</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E7%A8%8B%E5%BA%8F%E5%91%98%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%8497%E4%BB%B6%E4%BA%8B/">程序员应该知道的97件事</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E7%BC%96%E5%86%99%E5%8F%AF%E8%AF%BB%E4%BB%A3%E7%A0%81%E7%9A%84%E8%89%BA%E6%9C%AF/">编写可读代码的艺术</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E7%BC%96%E7%A8%8B%E5%8C%A0%E8%89%BA/">编程匠艺</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/">领域驱动设计</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/codelife_%E4%B8%8D%E6%AD%A2%E4%BB%A3%E7%A0%81/">codelife_不止代码</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">调试技术</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../debug/%E8%BD%AF%E4%BB%B6%E8%B0%83%E8%AF%95%E4%BF%AE%E7%82%BC%E4%B9%8B%E9%81%93/book/">软件调试修炼之道</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../debug/Effective_Debugging/">Effective Debugging</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">数据库</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/getting_started_with_impala/">Getting started with impala</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/mysql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/">mysql必知必会</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/mysql%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B8%8E%E6%9E%B6%E6%9E%84%E5%AE%9E%E8%B7%B5/">mysql性能调优与架构实践</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/Mysql%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95InnoDB%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/">Mysql技术内幕InnoDB存储引擎</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/redis%E5%AE%9E%E6%88%98/">Redis实战</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/redis%E6%B7%B1%E5%BA%A6%E5%8E%86%E9%99%A9%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E5%92%8C%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/book/">Redis深度历险核心原理和应用实践</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/">redis设计与实现</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/%E4%B8%83%E5%91%A8%E4%B8%83%E6%95%B0%E6%8D%AE%E5%BA%93/">七周七数据库</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAmysql/">深入浅出mysql</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E7%AC%AC%E4%B8%89%E7%89%88/">高性能mysql第三版</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">前端</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../frontend/CSS_The_Missing_Manual/">CSS_The_Missing_Manual</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../frontend/reactjs_%E5%B0%8F%E4%B9%A6/">reactjs小书</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../frontend/es6%E6%A0%87%E5%87%86%E5%85%A5%E9%97%A8/">ES6标准入门</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../frontend/jquery_pocket_reference/">jquery_pocket_reference</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../frontend/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3bootstrap/">深入理解bootstrap</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">golang</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../../1_the_go_programming_lauguage/">1 The Go Programming Language</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../2_the_go_programming_lauguage/">2 The Go Programming Language</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../3_the_go_programming_lauguage/">3 The Go Programming Language</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../build-web-application-with-golang/">Build Web Application With Golang</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go101/book/">Go101</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../network-programming-with-go/book/">Network Programming with go</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../building-microservices-with-go/book/">Building Microservices With Go</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../building_restful_web_services_with_go/book/">Building Restful Web Services with Go</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../concurrency-in-go/concurrency_in_go/">Concurrency In Go</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go_in_action%28go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98%29/">Go In Action(Go 实战)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E8%AF%AD%E8%A8%80%E8%AF%A6%E8%A7%A3/">Go学习笔记语言详解</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/">Go学习笔记源码剖析</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B/">go语言编程</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">go book</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#113-type-assertion">11.3 type assertion</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1192-contsucting-an-array-of-a-general-type-or-with-variables-of-different-types">11.9.2 contsucting an array of a general type or with variables of different types</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1110-the-reflect-package">11.10 The reflect package</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1114-structs-coolections-and-higher-order-functions">11.14 Structs coolections and higher order functions</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced-go-programming-book/advanced-go-programming/">advanced-go-programming</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go-build-web-applications/module1/go-build-web-applications/go-build-web-applications/">go-build-web-applications</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">java</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../java/java-basic-introduction/">java basic introduction</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">网络</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../network/tcp_ip%E8%AF%A6%E8%A7%A3%E5%8D%B7%E4%B8%80/tcp_ip%E8%AF%A6%E8%A7%A3%E5%8D%B7%E4%B8%80/">TCP IP详解卷一</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">python</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../python/fluent_python/">Fluent Python</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../python/Python_Microservices_Development/">Python Microservices Development</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../python/high_performance_python/">High Performance Python</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../python/python_%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">Python网络编程</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">unix/linux</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../unix_linux/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/">Linux高性能服务器编程</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../unix_linux/unix%E7%BC%96%E7%A8%8B%E8%89%BA%E6%9C%AF/">unix编程艺术</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../unix_linux/unix%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%8D%B7%E4%B8%80/">unix网络编程卷一</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../unix_linux/unix%E7%BC%96%E7%A8%8B%E8%89%BA%E6%9C%AF/">unix编程艺术</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">分布式</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%88%86%E5%B8%83%E5%BC%8F/Kafka%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97/">Kafka 权威指南</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E6%A1%86%E6%9E%B6%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/">分布式框架原理与应用</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%88%86%E5%B8%83%E5%BC%8F/%E5%A4%A7%E8%A7%84%E6%A8%A1%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F/">大规模分布式存储系统</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%88%86%E5%B8%83%E5%BC%8F/%E6%B7%B1%E5%85%A5%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%B0%E5%AE%9E%E8%B7%B5/">深入分布式缓存从原理到实践</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">搜索引擎</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/Elasticsearch%E5%AE%9E%E6%88%98/book/">Elasticsearch实战</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">容器</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../devops/%E7%8E%A9%E8%BD%ACKubernets-CloudMan/">玩转Kubernets</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../devops/%E7%AC%AC%E4%B8%80%E6%9C%ACdocker%E4%B9%A6/">第一本docker书</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">开发工具</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/practical_vim/practical_vim/">Practical Vim</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/vim8%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%AE%9E%E6%88%98/vim8%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%AE%9E%E6%88%98/">Vim8文本处理实战</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/learn_vim_the_hard_way/">Learn vim scrpt the hard way</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/pro_git/">Pro Git</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Mastering_vim/">Mastering Vim</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/mastering_vim_quickly/">Mastering Vim Quickly</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">思维</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E4%B8%93%E6%B3%A8%E5%8A%9B_%E5%8C%96%E7%B9%81%E4%B8%BA%E7%AE%80%E7%9A%84%E6%83%8A%E4%BA%BA%E5%8A%9B%E9%87%8F/">专注力</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E4%B8%BA%E4%BB%80%E4%B9%88%E7%B2%BE%E8%8B%B1%E8%BF%99%E6%A0%B7%E7%94%A8%E8%84%91%E4%B8%8D%E4%BC%9A%E7%B4%AF/">为什么精英这样用脑不会累</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%88%BB%E6%84%8F%E7%BB%83%E4%B9%A0/">刻意练习</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%A6%82%E4%BD%95%E6%83%B3%E5%88%B0%E5%8F%88%E5%81%9A%E5%88%B0/">如何想到又做到</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%AD%A6%E4%B9%A0%E4%B9%8B%E9%81%93/">学习之道</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">学习力</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E6%89%B9%E5%88%A4%E6%80%A7%E6%80%9D%E7%BB%B4%E5%B7%A5%E5%85%B7/">批判性思维工具</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E6%80%9D%E7%BB%B4%E4%BF%AE%E7%82%BC%28%E5%BC%80%E5%8F%91%E8%AE%A4%E7%9F%A5%E6%BD%9C%E8%83%BD%E7%9A%84%E4%B9%9D%E5%A0%82%E8%AF%BE%29/">程序员的思维修炼</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E8%AE%A4%E7%9F%A5%E5%A4%A9%E6%80%A7/">认知天性</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E8%B6%85%E6%95%88%E7%8E%87%E6%89%8B%E5%86%8C/">超效率手册</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E8%AE%B0%E5%BF%86/">如何高效记忆</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E7%A7%91%E5%AD%A6%E5%AD%A6%E4%B9%A0/">科学学习</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E9%AB%98%E6%95%88%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%8445%E4%B8%AA%E4%B9%A0%E6%83%AF/">高效程序员的45个习惯</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">源码</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB_sourcecode/">源码阅读</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">网站架构微服务</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/microservices_patterns_%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/book/">微服务架构设计模式</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%9E%B6%E6%9E%84/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%9E%B6%E6%9E%84/">从0开始学架构</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/web_scalavility_for_startup_engineers/">web scalavility for startup engineers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/design_data_instensive_application/">design_data_instensive_application</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/clean_architecture/">clean_architecture</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%AE%BE%E8%AE%A1/">微服务设计</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/2_design_data_instensive_application/">2_design_data_instensive_application</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/3_design_data_instensive_application/">3_design_data_instensive_application</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">软件工程/项目管理</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D/">人月神话</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E4%BB%A3%E7%A0%81%E4%B9%8B%E6%AE%87/">代码之殇</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E8%A7%A3%E6%9E%90%E6%9E%81%E9%99%90%E7%BC%96%E7%A8%8B-%E6%8B%A5%E6%8A%B1%E5%8F%98%E5%8C%96/">解析极限编程</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E4%BF%AE%E7%82%BC%E4%B9%8B%E9%81%93/">项目管理修炼之道</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E4%BF%AE%E6%94%B9%E8%BD%AF%E4%BB%B6%E7%9A%84%E8%89%BA%E6%9C%AF/">修改软件的艺术</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">运维</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BF%90%E7%BB%B4/linux%E9%9B%86%E7%BE%A4%E5%92%8C%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/">linux集群和自动化运维</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BF%90%E7%BB%B4/python%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/">python自动化运维</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">金融理财</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E9%87%91%E8%9E%8D%E7%90%86%E8%B4%A2/%E5%AE%9A%E6%8A%95%E5%8D%81%E5%B9%B4/">定投十年</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E9%87%91%E8%9E%8D%E7%90%86%E8%B4%A2/%E7%A9%B7%E6%9F%A5%E7%90%86%E5%AE%9D%E5%85%B8/">穷查理宝典</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">写作</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%86%99%E4%BD%9C/%E5%88%B7%E5%B1%8F%E6%96%87%E6%A1%88%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/">刷屏文案写作技巧</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">互联网</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E4%BA%92%E8%81%94%E7%BD%91/%E6%88%91%E7%9A%84%E4%BA%92%E8%81%94%E7%BD%91%E6%96%B9%E6%B3%95%E8%AE%BA-%E5%91%A8%E9%B8%BF%E7%A5%8E/">我的互联网方法论-周鸿祎</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E4%BA%92%E8%81%94%E7%BD%91/%E7%94%A8%E6%88%B7%E6%80%9D%E7%BB%B4/">用户思维</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">区块链</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E6%8C%87%E5%8D%97%28blockchain_guide%29/">区块链技术指南</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">技术演讲</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../lecture/Gopher/%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E7%9A%84go%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%9E%E6%88%98/note/">哔哩哔哩的go微服务实战</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../lecture/Gopher/Go_Error/go%E4%B8%9A%E5%8A%A1%E5%9F%BA%E7%A1%80%E5%BA%93%E4%B9%8BError%26Context/">go业务基础库之Error&Context</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../lecture/Gopher/Go%E5%90%8C%E6%AD%A5%E5%92%8C%E5%B9%B6%E5%8F%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/note/">Go同步和并发设计模式</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../lecture/%E6%8A%80%E6%9C%AF%E6%BC%94%E8%AE%B2/%E5%B7%A6%E8%80%B3%E6%9C%B5%E8%80%97%E5%AD%90-%E6%88%91%E8%BF%99%E6%8A%80%E6%9C%AF%E4%BA%8C%E5%8D%81%E5%B9%B4/">左耳朵耗子-我这技术二十年</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">职场</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/give_and_take/">give and take</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/the_effective_engineer/">the_effective_engineer</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E5%85%89%E9%80%9F%E6%88%90%E9%95%BF/">光速成长</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E5%90%91%E4%B8%8A%E7%AE%A1%E7%90%86/">向上管理</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E6%88%90%E5%8A%9F%E5%8A%A8%E6%9C%BA%E4%B8%8E%E7%9B%AE%E6%A0%87/">成功动机与目标</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E7%95%AA%E8%8C%84%E5%B7%A5%E4%BD%9C%E6%B3%95/">番茄工作法</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%81%86%E5%90%AC%E6%B2%9F%E9%80%9A%E5%AD%A6/">聆听沟通学</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E7%9F%A5%E4%B9%8E%E8%81%8C%E4%BA%BA%E8%A7%89%E9%86%92/">知乎职人觉醒</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E7%9F%A5%E8%AF%86%E5%8F%98%E7%8E%B0/">知识变现</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%81%86%E5%90%AC%E6%B2%9F%E9%80%9A%E5%AD%A6/">聆听沟通学</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%81%8C%E5%9C%BA%E5%8A%A8%E7%89%A9%E8%BF%9B%E5%8C%96%E6%89%8B%E5%86%8C/">职场动物进化手册</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%81%8C%E5%9C%BA%E8%A7%A3%E9%87%8A%E7%B3%BB/">职场解释系</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%AF%B7%E5%81%9C%E6%AD%A2%E6%97%A0%E6%95%88%E5%8A%AA%E5%8A%9B/">请停止无效努力</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%BD%AF%E6%8A%80%E8%83%BD/">软技能</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E9%AB%98%E6%95%8815%E6%B3%95%E5%88%99/">高效15法则</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E9%AB%98%E6%95%88%E6%B8%85%E5%8D%95%E5%B7%A5%E4%BD%9C%E6%B3%95/">高效清单工作法</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/">程序员的自我修养</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">心理学</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E7%AB%A5%E5%B9%B4%E7%9A%84%E9%94%99%E5%90%97/">一切都是童年的错吗</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E4%BA%B2%E5%AF%86%E5%85%B3%E7%B3%BB/">亲密关系</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E6%83%85%E5%95%86/">情商</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E9%80%86%E5%95%86/">逆商</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E6%8B%96%E5%BB%B6%E5%BF%83%E7%90%86%E5%AD%A6/">拖延心理学</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E7%A7%AF%E6%9E%81%E5%BF%83%E7%90%86%E5%AD%A6/">积极心理学</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E8%87%AA%E6%8E%A7%E5%8A%9B/">自控力</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E8%87%AA%E6%8E%A7%E5%8A%9B-%E5%AE%9E%E6%93%8D%E7%AF%87/">自控力-实操篇</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E8%87%AA%E6%8E%A7%E5%8A%9B-%E5%92%8C%E5%8E%8B%E5%8A%9B%E5%81%9A%E6%9C%8B%E5%8F%8B/">自控力:和压力做朋友</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E6%B4%BB%E5%87%BA%E6%9C%80%E4%B9%90%E8%A7%82%E7%9A%84%E8%87%AA%E5%B7%B1/">活出最乐观的自己</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E6%94%B9%E5%8F%98%E5%BF%83%E7%90%86%E5%AD%A6%E7%9A%8440%E9%A1%B9%E7%A0%94%E7%A9%B6/">改变心理学的40项研究</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E8%B6%85%E8%B6%8A%E8%87%AA%E5%8D%91/">超越自卑</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E5%8F%8D%E8%84%86%E5%BC%B1/">反脆弱</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">创业</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../startup/hello_startup/">Hello Startup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../startup/%E6%96%AF%E5%9D%A6%E7%A6%8F%E5%85%AC%E5%BC%80%E8%AF%BE-%E5%A6%82%E4%BD%95%E5%88%9B%E4%B8%9A/">斯坦福公开课如何创业</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../startup/%E8%BF%90%E8%90%A5%E5%85%B6%E5%AE%9E%E5%BE%88%E7%AE%80%E5%8D%95/">运营其实很简单</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">ZWiley的读书笔记</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>golang &raquo;</li>
        
      
    
    <li>go book</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/zwiley/mybook/edit/master/docs/golang/the_way_to_go/book.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="11-interfaces-and-reflection">11 Interfaces and reflection<a class="headerlink" href="#11-interfaces-and-reflection" title="Permanent link">&para;</a></h1>
<p>An Interface define a set of methods. And cannot contain variables.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">type</span> <span class="nx">Namer</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">Method1</span><span class="p">(</span><span class="nx">param_list</span><span class="p">)</span> <span class="nx">return_type</span>
    <span class="nx">Method2</span><span class="p">(</span><span class="nx">param_list</span><span class="p">)</span> <span class="nx">return_type</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="113-type-assertion">11.3 type assertion<a class="headerlink" href="#113-type-assertion" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="k">if</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">varI</span><span class="p">.(</span><span class="nx">T</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
<span class="c1">//</span>
<span class="p">}</span>
</code></pre></div>


<p>Value-received methods can be called with pointer values because they can be dereference first.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">package</span> <span class="nx">sort</span>

<span class="kd">type</span> <span class="nx">Sorter</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">Len</span><span class="p">()</span> <span class="kt">int</span>
    <span class="nx">Less</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">jint</span><span class="p">)</span> <span class="kt">bool</span>
    <span class="nx">Swap</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">j</span> <span class="kt">int</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">fucn</span> <span class="nx">Sort</span><span class="p">(</span><span class="nx">data</span> <span class="nx">Sorter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nx">pass</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">pass</span> <span class="p">&lt;</span><span class="nx">data</span><span class="p">.</span><span class="nx">Len</span><span class="p">();</span> <span class="nx">pass</span> <span class="o">++</span> <span class="p">{</span>
        <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">Len</span><span class="p">()</span><span class="o">-</span><span class="nx">pass</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
            <span class="k">if</span> <span class="nx">data</span><span class="p">.</span><span class="nx">Less</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">data</span><span class="p">.</span><span class="nx">Swap</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">IsSorted</span><span class="p">(</span><span class="nx">data</span> <span class="nx">Sorter</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
    <span class="nx">n</span> <span class="o">:=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">Len</span><span class="p">()</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="nx">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&gt;</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span> <span class="p">{</span>
        <span class="k">if</span> <span class="nx">data</span><span class="p">.</span><span class="nx">Less</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span> <span class="kc">false</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="c1">// convenience types for common cases</span>

<span class="kd">type</span> <span class="nx">IntArray</span> <span class="p">[]</span><span class="kt">int</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">p</span> <span class="nx">IntArray</span><span class="p">)</span> <span class="nx">Len</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span><span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nx">p</span><span class="p">)}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">p</span> <span class="nx">IntArray</span><span class="p">)</span> <span class="nx">Less</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span><span class="k">return</span> <span class="nx">p</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">&lt;</span> <span class="nx">p</span><span class="p">[</span><span class="nx">j</span><span class="p">]}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">p</span> <span class="nx">IntArray</span><span class="p">)</span> <span class="nx">Swap</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span><span class="nx">p</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="nx">p</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="p">=</span> <span class="nx">p</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span><span class="nx">p</span><span class="p">[</span><span class="nx">i</span><span class="p">]}</span>
</code></pre></div>


<h3 id="1192-contsucting-an-array-of-a-general-type-or-with-variables-of-different-types">11.9.2 contsucting an array of a general type or with variables of different types<a class="headerlink" href="#1192-contsucting-an-array-of-a-general-type-or-with-variables-of-different-types" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">type</span> <span class="nx">Element</span> <span class="kd">interface</span><span class="p">{}</span>

<span class="kd">type</span> <span class="nx">Vector</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">a</span> <span class="p">[]</span><span class="nx">Element</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">p</span> <span class="o">*</span><span class="nx">Vector</span><span class="p">)</span> <span class="nx">At</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">)</span> <span class="nx">Element</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">p</span><span class="p">.</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">p</span> <span class="o">*</span><span class="nx">Vector</span><span class="p">)</span> <span class="nx">Set</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">Element</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">p</span><span class="p">.</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">=</span> <span class="nx">e</span>
<span class="p">}</span>
</code></pre></div>


<p>tree struct:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">type</span> <span class="nx">Node</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">le</span>   <span class="o">*</span><span class="nx">Node</span>
    <span class="nx">data</span> <span class="kd">interface</span><span class="p">{}</span>
    <span class="nx">ri</span>   <span class="o">*</span><span class="nx">Node</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">NewNode</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">right</span> <span class="o">*</span><span class="nx">Node</span><span class="p">)</span> <span class="o">*</span><span class="nx">Node</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&amp;</span><span class="nx">Node</span><span class="p">{</span><span class="nx">left</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">right</span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">n</span> <span class="o">*</span><span class="nx">Node</span><span class="p">)</span> <span class="nx">SetData</span><span class="p">(</span><span class="nx">data</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">{</span>
    <span class="nx">n</span><span class="p">.</span><span class="nx">data</span> <span class="p">=</span> <span class="nx">data</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">root</span> <span class="o">:=</span> <span class="nx">NewNode</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">SetData</span><span class="p">(</span><span class="s">&quot;root node&quot;</span><span class="p">)</span>
    <span class="nx">a</span> <span class="o">:=</span> <span class="nx">NewNode</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="nx">a</span><span class="p">.</span><span class="nx">SetData</span><span class="p">(</span><span class="s">&quot;left node&quot;</span><span class="p">)</span>
    <span class="nx">b</span> <span class="o">:=</span> <span class="nx">NewNode</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">SetData</span><span class="p">(</span><span class="s">&quot;right node&quot;</span><span class="p">)</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">le</span> <span class="p">=</span> <span class="nx">a</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">ri</span> <span class="p">=</span> <span class="nx">b</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%v\n&quot;</span><span class="p">,</span> <span class="nx">root</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="1110-the-reflect-package">11.10 The reflect package<a class="headerlink" href="#1110-the-reflect-package" title="Permanent link">&para;</a></h2>
<h2 id="1114-structs-coolections-and-higher-order-functions">11.14 Structs coolections and higher order functions<a class="headerlink" href="#1114-structs-coolections-and-higher-order-functions" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="kn">package</span> <span class="nx">main</span>

<span class="kd">type</span> <span class="nx">Any</span> <span class="kd">interface</span><span class="p">{}</span>

<span class="kd">type</span> <span class="nx">Car</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Model</span>        <span class="kt">string</span>
    <span class="nx">Manufacturer</span> <span class="kt">string</span>
    <span class="nx">BuildYear</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Cars</span> <span class="p">[]</span><span class="o">*</span><span class="nx">Car</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">cs</span> <span class="nx">Cars</span><span class="p">)</span> <span class="nx">Map</span><span class="p">(</span><span class="nx">f</span> <span class="kd">func</span><span class="p">(</span><span class="nx">car</span> <span class="o">*</span><span class="nx">Car</span><span class="p">)</span> <span class="nx">Any</span><span class="p">)</span> <span class="p">[]</span><span class="nx">Any</span> <span class="p">{</span>
    <span class="nx">result</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="nx">Any</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nx">ix</span> <span class="o">:=</span> <span class="mi">0</span>
    <span class="nx">cs</span><span class="p">.</span><span class="nx">Process</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Car</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">[</span><span class="nx">ix</span><span class="p">]</span> <span class="p">=</span> <span class="nx">f</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
        <span class="nx">ix</span><span class="o">++</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="nx">result</span>
<span class="p">}</span>

<span class="nx">allNewBMWs</span> <span class="o">:=</span> <span class="nx">allCars</span><span class="p">.</span><span class="nx">FindAll</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">car</span> <span class="o">*</span><span class="nx">Car</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">car</span><span class="p">.</span><span class="nx">Manufacturer</span> <span class="o">==</span> <span class="s">&quot;BMW&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">car</span><span class="p">.</span><span class="nx">BuildYear</span> <span class="p">&gt;</span> <span class="mi">2010</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div>


<h1 id="12-reading-and-writing">12 Reading and writing<a class="headerlink" href="#12-reading-and-writing" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="c1">// read input from console:</span>
<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">var</span> <span class="p">(</span>
    <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Scanln</span><span class="p">(</span><span class="o">*</span><span class="nx">firstName</span><span class="p">,</span> <span class="o">*</span><span class="nx">lastName</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Hi %s %s\n&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">firstName</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// or use bufio.Reader</span>
</code></pre></div>


<h1 id="13-error-handling-and-testing">13 Error-handling and Testing<a class="headerlink" href="#13-error-handling-and-testing" title="Permanent link">&para;</a></h1>
<p>no try/catch, defer-panic-and-recover mechanism.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">type</span> <span class="kt">error</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">Error</span><span class="p">()</span> <span class="kt">string</span>
<span class="p">}</span>
<span class="c1">// to stop an error-state program, use os.Exit(1)</span>


<span class="c1">// define new errors</span>
<span class="nx">err</span> <span class="o">:=</span> <span class="nx">errros</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;math-square root of negative number&quot;</span><span class="p">)</span>

<span class="c1">// custome error field</span>
<span class="kd">type</span> <span class="nx">PathError</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Op</span>   <span class="kt">string</span>
    <span class="nx">Path</span> <span class="kt">string</span>
    <span class="nx">Err</span>  <span class="kt">error</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span> <span class="nx">e</span> <span class="o">*</span><span class="nx">PathError</span><span class="p">)</span> <span class="nx">String</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">Op</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">Path</span> <span class="p">=</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">Err</span><span class="p">.</span><span class="nx">Error</span><span class="p">()</span>
<span class="p">}</span>
<span class="c1">// making errror-object with fmt</span>
<span class="k">if</span> <span class="nx">f</span> <span class="p">&lt;</span> <span class="mi">0</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;math: square root of negative number %g&quot;</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="132-run-time-exceptions-and-panic">13.2 Run-time exceptions and panic<a class="headerlink" href="#132-run-time-exceptions-and-panic" title="Permanent link">&para;</a></h2>
<p>if panic is called from a nested function, immediately stops the execution of the current function,
all defer statement are guaranteed to execute and the control is given to the function caller, which receives this call
to panic.</p>
<h2 id="133-recover">13.3 Recover<a class="headerlink" href="#133-recover" title="Permanent link">&para;</a></h2>
<p>recover is only useful when called inside a deferred function: it then retrieves the error value passed through the call
of panic; when used in normal execution a call to recover will return nil and have no other effects.</p>
<p>like catch in java.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">protect</span><span class="p">(</span><span class="nx">g</span> <span class="kd">func</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">defer</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;done&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nb">recover</span><span class="p">();</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;run time panic : %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}()</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
    <span class="nx">g</span><span class="p">()</span>
<span class="p">}</span>


<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">badCall</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">panic</span><span class="p">(</span><span class="s">&quot;bad end&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">defer</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="nx">e</span> <span class="o">:=</span> <span class="nb">recover</span><span class="p">();</span> <span class="nx">e</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;Panicking %s\r\n&quot;</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}()</span>
    <span class="nx">badCall</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;After bad call\r\n&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;calling test\r\n&quot;</span><span class="p">)</span>
    <span class="nx">test</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;calling test end\r\n&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="134-error-handling-and-panicking-in-a-custom-package">13.4 Error-handling and panicking in a custom package<a class="headerlink" href="#134-error-handling-and-panicking-in-a-custom-package" title="Permanent link">&para;</a></h2>
<p>best practice:</p>
<ul>
<li>always recover from panic in your package: no explicit panic() should be allowed to cross a package boundary</li>
<li>return errors as error values to the callers of your package.</li>
</ul>
<h2 id="135-an-error-handling-scheme-with-closures">13.5 An Error-handling scheme with closures<a class="headerlink" href="#135-an-error-handling-scheme-with-closures" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span> <span class="nx">type1</span><span class="p">,</span> <span class="nx">b</span> <span class="nx">type2</span><span class="p">)</span>

<span class="nx">fType1</span> <span class="p">=</span> <span class="kd">func</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span> <span class="nx">type1</span><span class="p">,</span> <span class="nx">b</span> <span class="nx">type2</span><span class="p">)</span>


<span class="kd">func</span> <span class="nx">errorHandler</span><span class="p">(</span><span class="nx">fn</span> <span class="nx">fType1</span><span class="p">)</span> <span class="nx">fType1</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">a</span> <span class="nx">type1</span><span class="p">,</span> <span class="nx">b</span> <span class="nx">type2</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">defer</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="nx">e</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nb">recover</span><span class="p">().(</span><span class="kt">error</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
                <span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;run time panic:%v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}()</span>
        <span class="nx">fn</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="136-starting-an-external-command-or-program">13.6 Starting an external command or program<a class="headerlink" href="#136-starting-an-external-command-or-program" title="Permanent link">&para;</a></h2>
<p>os.StartProcess
exec.Command(name string, arg &hellip;string)</p>
<h2 id="137-testing-and-benckmarking-in-go">13.7 Testing and benckmarking in GO<a class="headerlink" href="#137-testing-and-benckmarking-in-go" title="Permanent link">&para;</a></h2>
<h1 id="14-goroutines-and-channels">14 Goroutines and channels<a class="headerlink" href="#14-goroutines-and-channels" title="Permanent link">&para;</a></h1>
<h2 id="141-concurrency-parallelism-and-goroutines">14.1 Concurrency, parallelism and goroutines<a class="headerlink" href="#141-concurrency-parallelism-and-goroutines" title="Permanent link">&para;</a></h2>
<p>CSP(Communicating Sequentiadl Processes)</p>
<p>parallelism is the ability to make things run quickly by using multiple processors.</p>
<p>An experiential rule of thumb seems to be that for n cores setting GOMAXPROCS to n-1 yields the best the performance,
and the following should also be followed: number of goroutines &gt; 1 + GOMAXPROCS &gt; 1</p>
<p>If we do not wai int main(), the program stop the goroutines die with it.
When the func main() returns, the program exits, it does not wait for other (non-main) goroutines to complete.
The logic of your code must be independent of the order in which goroutines are invoked.</p>
<h3 id="1415">14.1.5<a class="headerlink" href="#1415" title="Permanent link">&para;</a></h3>
<p>difference bewteen goroutines and coroutines(c# and python):</p>
<ul>
<li>goroutines imply parallelism, coroutines in general do not</li>
<li>goroutines communicate via channels; coroutines communicate via yield and resume operations</li>
</ul>
<h2 id="142-channels-for-communication-between-goroutines">14.2 Channels for communication between goroutines<a class="headerlink" href="#142-channels-for-communication-between-goroutines" title="Permanent link">&para;</a></h2>
<p>Using shared variables is not discouranged.
Only one goroutine has access to a  data item at any given time: so data races cannot occur, by design. Channels a firstclass objects.</p>
<div class="codehilite"><pre><span></span><code><span class="err">var identifier chan datatype // uniniitialized channel is nil</span>
<span class="err">var cha1 chan string // reference type</span>
<span class="err">ch1 = make(chan string)</span>
</code></pre></div>


<p>Channel send and receive operations are aotmic, they always complete without interruption.</p>
<h3 id="1423-blocking-of-channels">14.2.3 Blocking of channels<a class="headerlink" href="#1423-blocking-of-channels" title="Permanent link">&para;</a></h3>
<p>default communication is synchronous and unbuffered: sends do not complete until there is a receiver to accept the value. So channel send/receive block until the other side is ready.</p>
<ul>
<li>A send opeartion on a channel blocks until a receiver is available. for the same channel.</li>
<li>A receive operation for a channel blocks until a sender is available for the same channel.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;fmt&quot;</span>
    <span class="s2">&quot;time&quot;</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ch1</span> <span class="p">:</span><span class="o">=</span> <span class="n">make</span><span class="p">(</span><span class="n">chan</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">go</span> <span class="n">pump</span><span class="p">(</span><span class="n">ch1</span><span class="p">)</span>
    <span class="o">//</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="n">ch1</span><span class="p">)</span>
    <span class="n">go</span> <span class="n">suck</span><span class="p">(</span><span class="n">ch1</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">pump</span><span class="p">(</span><span class="n">ch</span> <span class="n">chan</span> <span class="nb">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="n">ch</span> <span class="o">&lt;-</span> <span class="n">i</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">suck</span><span class="p">(</span><span class="n">ch</span> <span class="n">chan</span> <span class="nb">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="n">ch</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h3 id="1425-asynchronous-channels-making-a-channel-with-a-buffer">14.2.5 Asynchronous channels-making a channel with a buffer<a class="headerlink" href="#1425-asynchronous-channels-making-a-channel-with-a-buffer" title="Permanent link">&para;</a></h3>
<p>An unbuffered channel can only contain 1 item and is for that reason somethimes too restrictive.</p>
<div class="codehilite"><pre><span></span><code><span class="err">buf := 100</span>
<span class="err">ch1 := make(chan string, buf) //buf is the number of elements the channel can hold</span>
</code></pre></div>


<p>sending to a bufferd channel will not blocked unless buffer is full, reading not blocked unless buffer is empty.
If the capacity is greater than 0, channel is asychronous</p>
<p>Semaphore pattern</p>
<div class="codehilite"><pre><span></span><code>    <span class="n">ch</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="n">int</span><span class="p">)</span>
    <span class="n">go</span> <span class="nf">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">do</span> <span class="n">something</span>
        <span class="n">ch</span> <span class="o">&lt;-</span> <span class="m">1</span>
    <span class="p">}()</span>
    <span class="nf">doSomethingElseForAWhile</span><span class="p">()</span>
    <span class="o">&lt;-</span><span class="n">ch</span> <span class="o">//</span> <span class="n">wait</span> <span class="n">for</span> <span class="n">goroutine</span> <span class="n">to</span> <span class="n">finish.</span> <span class="n">discard</span> <span class="n">send</span> <span class="n">value</span>
</code></pre></div>


<h3 id="1429-implementing-a-semaphore-using-a-buffered-channel">14.2.9 Implementing a semaphore using a buffered channel<a class="headerlink" href="#1429-implementing-a-semaphore-using-a-buffered-channel" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">type</span> <span class="n">Empty</span> <span class="n">interface</span><span class="p">{}</span>
<span class="n">type</span> <span class="n">semaphore</span> <span class="n">chan</span> <span class="n">Empty</span>


<span class="n">sem</span> <span class="o">=</span> <span class="nf">make</span><span class="p">(</span><span class="n">semaphore</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="o">//</span> <span class="n">acauire</span> <span class="n">n</span> <span class="n">resourdces</span>
<span class="nf">func </span><span class="p">(</span><span class="n">s</span> <span class="n">semaphore</span><span class="p">)</span> <span class="nf">P</span><span class="p">(</span><span class="n">n</span> <span class="n">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span> <span class="o">:=</span> <span class="nf">new</span><span class="p">(</span><span class="n">Empty</span><span class="p">)</span>
    <span class="n">for</span> <span class="n">i</span> <span class="o">:=</span><span class="m">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">{</span>
        <span class="n">s</span> <span class="o">&lt;-</span> <span class="n">e</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="o">//</span> <span class="n">release</span> <span class="n">n</span> <span class="n">resources</span>
<span class="nf">func </span><span class="p">(</span><span class="n">s</span> <span class="n">semaphore</span><span class="p">)</span> <span class="nf">V</span><span class="p">(</span><span class="n">n</span> <span class="n">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">for</span> <span class="n">i</span> <span class="o">:=</span><span class="m">0</span> <span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span> <span class="o">++</span> <span class="p">{</span>
        <span class="o">&lt;-</span><span class="n">s</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">mutexes</span>
<span class="nf">func </span><span class="p">(</span><span class="n">s</span> <span class="n">semaphore</span><span class="p">)</span> <span class="nf">Lock</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">s.P</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">func </span><span class="p">(</span><span class="n">s</span> <span class="n">semaphore</span><span class="p">)</span> <span class="nf">Unlock</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">s.V</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">signal</span><span class="o">-</span><span class="n">wait</span>
<span class="nf">func </span><span class="p">(</span><span class="n">s</span> <span class="n">semaphore</span><span class="p">)</span> <span class="nf">Wait</span><span class="p">(</span><span class="n">n</span> <span class="n">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">s.P</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">func </span><span class="p">(</span><span class="n">s</span> <span class="n">semaphore</span><span class="p">)</span> <span class="nf">Signal</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">s.V</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<h3 id="14210-for-range-applied-to-channels">14.2.10 For-range applied to channels<a class="headerlink" href="#14210-for-range-applied-to-channels" title="Permanent link">&para;</a></h3>
<p>It reads from the given channel ch until the channel is closed and then the code following for continue to execute. Obviously another goroutine must be writing to ch(otherwise the executino blocks in the for-loop) and must close ch when it&rsquo;s done writing.</p>
<p>producer consumer pattern:</p>
<div class="codehilite"><pre><span></span><code><span class="err">for {</span>
<span class="err">    Consume(Product())</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="14211-channel-directionality">14.2.11 Channel directionality<a class="headerlink" href="#14211-channel-directionality" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">var</span> <span class="n">send_only</span> <span class="n">chan</span><span class="o">&lt;-</span> <span class="n">int</span> <span class="o">//</span> <span class="n">channel</span> <span class="n">can</span> <span class="n">only</span> <span class="n">receive</span> <span class="nf">data </span><span class="p">(</span><span class="o">&lt;-</span><span class="n">chan</span> <span class="bp">T</span><span class="p">)</span>
<span class="n">var</span> <span class="n">recv_only</span> <span class="o">&lt;-</span><span class="n">chan</span> <span class="n">int</span> <span class="o">//</span> <span class="n">channel</span> <span class="n">can</span> <span class="n">only</span> <span class="n">send</span> <span class="n">data</span>
</code></pre></div>


<p>IDIOM: Pipe and filter pattern</p>
<div class="codehilite"><pre><span></span><code><span class="n">sendChan</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="n">int</span><span class="p">)</span>
<span class="n">receiveChan</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="n">string</span><span class="p">)</span>
<span class="n">go</span> <span class="nf">processChannel</span><span class="p">(</span><span class="n">sendChan</span><span class="p">,</span> <span class="n">receiveChan</span><span class="p">)</span>

<span class="n">func</span> <span class="nf">processChannel</span><span class="p">(</span><span class="n">in</span> <span class="o">&lt;-</span> <span class="n">chan</span> <span class="n">int</span><span class="p">,</span> <span class="n">out</span> <span class="n">chan</span><span class="o">&lt;-</span> <span class="n">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">for</span> <span class="n">inValue</span> <span class="o">:=</span> <span class="n">range</span> <span class="n">in</span> <span class="p">{</span>
        <span class="n">result</span> <span class="o">:=</span> <span class="o">//</span> <span class="n">process</span> <span class="n">inValue</span>
        <span class="n">out</span><span class="o">&lt;-</span><span class="n">result</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">sieve</span> <span class="n">primer</span> <span class="n">number</span>
<span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="s2">&quot;fmt&quot;</span>

<span class="n">func</span> <span class="n">generate</span><span class="p">()</span> <span class="n">chan</span> <span class="nb">int</span> <span class="p">{</span>
    <span class="n">ch</span> <span class="p">:</span><span class="o">=</span> <span class="n">make</span><span class="p">(</span><span class="n">chan</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">go</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
            <span class="n">ch</span> <span class="o">&lt;-</span> <span class="n">i</span>
        <span class="p">}</span>
    <span class="p">}()</span>
    <span class="k">return</span> <span class="n">ch</span>
<span class="p">}</span>

<span class="n">func</span> <span class="nb">filter</span><span class="p">(</span><span class="ow">in</span> <span class="n">chan</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prime</span> <span class="nb">int</span><span class="p">)</span> <span class="n">chan</span> <span class="nb">int</span> <span class="p">{</span>
    <span class="n">out</span> <span class="p">:</span><span class="o">=</span> <span class="n">make</span><span class="p">(</span><span class="n">chan</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">go</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="o">&lt;-</span><span class="ow">in</span><span class="p">;</span> <span class="n">i</span><span class="o">%</span><span class="n">prime</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
                <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">i</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}()</span>
    <span class="k">return</span> <span class="n">out</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">sieve</span><span class="p">()</span> <span class="n">chan</span> <span class="nb">int</span> <span class="p">{</span>
    <span class="n">out</span> <span class="p">:</span><span class="o">=</span> <span class="n">make</span><span class="p">(</span><span class="n">chan</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">go</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">ch</span> <span class="p">:</span><span class="o">=</span> <span class="n">generate</span><span class="p">()</span>
        <span class="k">for</span> <span class="p">{</span>
            <span class="n">prime</span> <span class="p">:</span><span class="o">=</span> <span class="o">&lt;-</span><span class="n">ch</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">prime</span>
        <span class="p">}</span>
    <span class="p">}()</span>
    <span class="k">return</span> <span class="n">out</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">primes</span> <span class="p">:</span><span class="o">=</span> <span class="n">sieve</span><span class="p">()</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="n">primes</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="143-synchronization-of-goroutine-closing-a-channel-testing-for-blocked-channels">14.3 Synchronization of goroutine: closing a channel - testing for blocked channels<a class="headerlink" href="#143-synchronization-of-goroutine-closing-a-channel-testing-for-blocked-channels" title="Permanent link">&para;</a></h2>
<p>Only the sender should close a channel, never receiver.
Sending or Closing a closed channel causes a run-time panic.</p>
<div class="codehilite"><pre><span></span><code><span class="n">if</span> <span class="n">v</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="n">ch</span><span class="p">;</span> <span class="n">ok</span> <span class="p">{</span>
    <span class="nf">process</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<p>To do a non-blocking channel you need to use a select.
for range will automatically detect when the channel is closed.</p>
<h2 id="144-switching-between-goroutines-with-select">14.4 Switching between goroutines with select<a class="headerlink" href="#144-switching-between-goroutines-with-select" title="Permanent link">&para;</a></h2>
<p>Getting the values out of dirrerent concurrently executing goroutines can be accomplisehd with
the select ekyworkd. A select is terminated when a break or return is executed in one of its cases.</p>
<ul>
<li>if all are blocked, it waits until one can proceed</li>
<li>if multiple can proceed, it choose one at random</li>
<li>when none of the channel operations can proceed and default clause is present, default is always runnable</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">sieve</span> <span class="n">primer</span> <span class="n">number</span>
<span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;fmt&quot;</span>
    <span class="s2">&quot;runtime&quot;</span>
    <span class="s2">&quot;time&quot;</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">runtime</span><span class="o">.</span><span class="n">GOMAXPROCS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ch1</span> <span class="p">:</span><span class="o">=</span> <span class="n">make</span><span class="p">(</span><span class="n">chan</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">ch2</span> <span class="p">:</span><span class="o">=</span> <span class="n">make</span><span class="p">(</span><span class="n">chan</span> <span class="nb">int</span><span class="p">)</span>

    <span class="n">go</span> <span class="n">pump1</span><span class="p">(</span><span class="n">ch1</span><span class="p">)</span>
    <span class="n">go</span> <span class="n">pump2</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span>
    <span class="n">go</span> <span class="n">suck</span><span class="p">(</span><span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">pump1</span><span class="p">(</span><span class="n">ch</span> <span class="n">chan</span> <span class="nb">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="n">ch</span> <span class="o">&lt;-</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">pump2</span><span class="p">(</span><span class="n">ch</span> <span class="n">chan</span> <span class="nb">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="n">ch</span> <span class="o">&lt;-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">5</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">func</span> <span class="n">suck</span><span class="p">(</span><span class="n">ch1</span> <span class="n">chan</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ch2</span> <span class="n">chan</span> <span class="nb">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="n">select</span> <span class="p">{</span>
        <span class="n">case</span> <span class="n">v</span> <span class="p">:</span><span class="o">=</span> <span class="o">&lt;-</span><span class="n">ch1</span><span class="p">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s2">&quot;received on channel 1 :</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">case</span> <span class="n">v</span> <span class="p">:</span><span class="o">=</span> <span class="o">&lt;-</span><span class="n">ch2</span><span class="p">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s2">&quot;received on channel 2 :</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="145-channels-timeouts-and-tickers">14.5 Channels, Timeouts and Tickers<a class="headerlink" href="#145-channels-timeouts-and-tickers" title="Permanent link">&para;</a></h2>
<p>time.Ticker is an object that repeatedly sends a time value on a contained channel C at a specified time interval.</p>
<div class="codehilite"><pre><span></span><code><span class="n">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ticker</span> <span class="o">:=</span> <span class="nf">time.NewTicker</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
    <span class="n">defer</span> <span class="nf">ticker.Stop</span><span class="p">()</span>
    <span class="n">select</span> <span class="p">{</span>
    <span class="n">case</span> <span class="n">u</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="n">ch1</span><span class="o">:</span>
        <span class="o">//</span><span class="kc">...</span>
    <span class="n">case</span> <span class="n">v</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="n">ch2</span><span class="o">:</span>
        <span class="o">//</span><span class="kc">...</span>
    <span class="n">case</span> <span class="o">&lt;-</span><span class="n">ticker.C</span><span class="o">:</span>
        <span class="nf">logState</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="o">//</span> <span class="n">call</span> <span class="n">some</span> <span class="n">logging</span> <span class="n">function</span> <span class="n">logState</span>
    <span class="n">default</span><span class="o">:</span> <span class="o">//</span> <span class="n">novalue</span> <span class="n">ready</span> <span class="n">to</span> <span class="n">be</span> <span class="n">received</span>
        <span class="o">//</span><span class="kc">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>rate limiter:</p>
<div class="codehilite"><pre><span></span><code><span class="n">rate_per_sec</span> <span class="o">:=</span> <span class="m">10</span>
<span class="n">var</span> <span class="n">dur</span> <span class="n">Dration</span> <span class="o">=</span> <span class="m">1e9</span>
<span class="n">chRate</span> <span class="o">:=</span> <span class="nf">time.Tick</span><span class="p">(</span><span class="n">dur</span><span class="p">)</span>
<span class="n">for</span> <span class="n">req</span> <span class="o">:=</span> <span class="n">range</span> <span class="n">requests</span> <span class="p">{</span>
    <span class="o">&lt;-</span> <span class="n">chRate</span>
    <span class="n">go</span> <span class="nf">client.Call</span><span class="p">(</span><span class="s">&quot;service.Method&quot;</span><span class="p">,</span> <span class="n">req</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<p>time.After(d) only send time once:</p>
<div class="codehilite"><pre><span></span><code><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;fmt&quot;</span>
    <span class="s2">&quot;time&quot;</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">tick</span> <span class="p">:</span><span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">Tick</span><span class="p">(</span><span class="mf">1e8</span><span class="p">)</span>
    <span class="n">boom</span> <span class="p">:</span><span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">After</span><span class="p">(</span><span class="mf">5e8</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="n">select</span> <span class="p">{</span>
        <span class="n">case</span> <span class="o">&lt;-</span><span class="n">tick</span><span class="p">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s2">&quot;tick.&quot;</span><span class="p">)</span>
        <span class="n">case</span> <span class="o">&lt;-</span><span class="n">boom</span><span class="p">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s2">&quot;Boom.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">default</span><span class="p">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s2">&quot;     .&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="mf">5e7</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="146-using-recover-with-goroutines">14.6 Using recover with goroutines<a class="headerlink" href="#146-using-recover-with-goroutines" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="n">func</span> <span class="nf">server</span><span class="p">(</span><span class="n">workChan</span> <span class="o">&lt;-</span><span class="n">chan</span> <span class="o">*</span><span class="n">Work</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">for</span> <span class="n">work</span> <span class="o">:=</span> <span class="n">range</span> <span class="n">workChan</span> <span class="p">{</span>
        <span class="n">go</span> <span class="nf">safelyDo</span><span class="p">(</span><span class="n">work</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">func</span> <span class="nf">safelyDo</span><span class="p">(</span><span class="n">work</span> <span class="o">*</span><span class="n">Work</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">defer</span> <span class="nf">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="nf">recover</span><span class="p">();</span> <span class="n">err</span> <span class="o">!=</span><span class="n">nil</span> <span class="p">{</span>
            <span class="nf">log.Printf</span><span class="p">(</span><span class="s">&quot;work faield with %s in %v:&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">work</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}()</span>
    <span class="nf">do</span><span class="p">(</span><span class="n">work</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<h3 id="147-tasks-and-worker-processes">14.7 Tasks and Worker processes<a class="headerlink" href="#147-tasks-and-worker-processes" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">Master</span><span class="o">-</span><span class="n">worker</span> <span class="n">paradigm</span>
<span class="n">func</span> <span class="nf">Worker</span><span class="p">(</span><span class="n">in</span><span class="p">,</span> <span class="n">out</span> <span class="n">chan</span> <span class="o">*</span><span class="n">Task</span><span class="p">){</span>
    <span class="n">for</span> <span class="p">{</span>
        <span class="n">t</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="n">in</span>
        <span class="nf">process</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">t</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>when to use: a sync.Mutex or a channel?</p>
<ul>
<li>use locking(mutexes) when:
    - caching information in a shared data structure
    - holding state information, that is context or status of the running application</li>
</ul>
<ul>
<li>use channels when:
    - communicating asynchronous results
    - distributing units of work
    - passing owership of data</li>
</ul>
<h2 id="148-implementing-a-lazy-generator">14.8 Implementing a lazy generator<a class="headerlink" href="#148-implementing-a-lazy-generator" title="Permanent link">&para;</a></h2>
<p>A generator is a function that returns the next value in a sequence each time the function is called.</p>
<div class="codehilite"><pre><span></span><code><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="n">var</span> <span class="n">resume</span> <span class="n">chan</span> <span class="nb">int</span>

<span class="n">func</span> <span class="n">intergers</span><span class="p">()</span> <span class="n">chan</span> <span class="nb">int</span> <span class="p">{</span>
    <span class="k">yield</span> <span class="p">:</span><span class="o">=</span> <span class="n">make</span><span class="p">(</span><span class="n">chan</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">count</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span>
    <span class="n">go</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">{</span>
            <span class="k">yield</span> <span class="o">&lt;-</span> <span class="n">count</span>
            <span class="n">count</span><span class="o">++</span>
        <span class="p">}</span>
    <span class="p">}()</span>
    <span class="k">return</span> <span class="k">yield</span>
<span class="p">}</span>
<span class="n">func</span> <span class="n">generateInteger</span><span class="p">()</span> <span class="nb">int</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;-</span><span class="n">resume</span>
<span class="p">}</span>
<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">resume</span> <span class="o">=</span> <span class="n">intergers</span><span class="p">()</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">generateInteger</span><span class="p">())</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">generateInteger</span><span class="p">())</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">generateInteger</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="149-implementing-futures">14.9 Implementing Futures<a class="headerlink" href="#149-implementing-futures" title="Permanent link">&para;</a></h2>
<p>future: somtimes you know yopu need to compute a value before you need to actually use the value.
in this case, you can potentially start computing the value on another processor and have it ready
when you need it.</p>
<div class="codehilite"><pre><span></span><code><span class="n">func</span> <span class="nf">InverseProduct</span><span class="p">(</span><span class="n">a</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">b</span> <span class="n">Matrix</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">a_inv</span> <span class="o">:=</span> <span class="nf">Inverse</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">b_inv</span> <span class="o">:=</span> <span class="nf">Inverse</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">return</span> <span class="nf">Product</span><span class="p">(</span><span class="n">a_inv</span><span class="p">,</span> <span class="n">b_inv</span><span class="p">)</span>
<span class="p">}</span>


<span class="o">///</span> <span class="n">a_inv</span> <span class="n">and</span> <span class="n">b_inv</span> <span class="n">can</span> <span class="n">compute</span> <span class="n">parallel</span>

<span class="n">fucn</span> <span class="nf">InverseProduct</span><span class="p">(</span><span class="n">a</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">b</span> <span class="n">Matrix</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">a_inv_future</span> <span class="o">:=</span> <span class="nf">InverseFuture</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">//</span><span class="n">.</span> <span class="n">started</span> <span class="n">as</span> <span class="n">a</span> <span class="n">goroutine</span>
    <span class="n">b_inv_future</span> <span class="o">:=</span> <span class="nf">InverseFuture</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">a_inv</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="n">a_inv_future</span>
    <span class="n">b_inv</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="n">b_inv_future</span>
    <span class="n">return</span> <span class="nf">Product</span><span class="p">(</span><span class="n">a_inv</span><span class="p">,</span><span class="n">b_inv</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="nf">InverseFuture</span><span class="p">(</span><span class="n">a</span> <span class="n">Matrix</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">future</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="n">Matrix</span><span class="p">)</span>
    <span class="n">go</span> <span class="nf">func</span><span class="p">()</span> <span class="p">{</span> <span class="n">future</span><span class="o">&lt;-</span><span class="nf">Inverse</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="p">}</span> <span class="p">()</span> <span class="o">//</span> <span class="n">launched</span> <span class="n">a</span> <span class="n">closure</span> <span class="n">as</span> <span class="n">a</span> <span class="n">goroutine</span>
    <span class="n">return</span> <span class="n">future</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="1410-multiplexing">14.10 Multiplexing<a class="headerlink" href="#1410-multiplexing" title="Permanent link">&para;</a></h2>
<h2 id="1411-limiting-the-number-of-requests-processed-concurrently">14.11 Limiting the number of requests processed concurrently<a class="headerlink" href="#1411-limiting-the-number-of-requests-processed-concurrently" title="Permanent link">&para;</a></h2>
<h2 id="1412-chaining-goroutines">14.12 Chaining goroutines<a class="headerlink" href="#1412-chaining-goroutines" title="Permanent link">&para;</a></h2>
<h2 id="1413-parallelzing-a-computation-over-a-number-of-cores">14.13 Parallelzing a computation over a number of cores<a class="headerlink" href="#1413-parallelzing-a-computation-over-a-number-of-cores" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="n">func</span> <span class="nf">DoAll</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">sem</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="n">int</span><span class="p">,</span> <span class="n">NCPU</span><span class="p">)</span>
    <span class="n">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NCPU</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">{</span>
        <span class="n">go</span> <span class="nf">DoPart</span><span class="p">(</span><span class="n">sem</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="o">//</span> <span class="n">Drain</span> <span class="n">the</span> <span class="n">channel</span> <span class="n">sem</span><span class="p">,</span> <span class="n">waiting</span> <span class="n">for</span>  <span class="n">NCPU</span> <span class="n">tasks</span> <span class="n">to</span> <span class="n">complete</span>
    <span class="n">for</span> <span class="n">i</span><span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NCPU</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">{</span>
        <span class="o">&lt;-</span><span class="n">sem</span>
    <span class="p">}</span>
    <span class="o">//</span> <span class="n">All</span> <span class="n">done</span>
<span class="p">}</span>

<span class="n">func</span> <span class="nf">DoPart</span><span class="p">(</span><span class="n">sem</span> <span class="n">chan</span> <span class="n">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">do</span> <span class="n">the</span> <span class="n">part</span> <span class="n">of</span> <span class="n">the</span> <span class="n">computation</span>
    <span class="n">sem</span> <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">//</span> <span class="n">signal</span> <span class="n">that</span> <span class="n">thie</span> <span class="n">piece</span> <span class="n">is</span> <span class="n">done</span>
<span class="p">}</span>

<span class="n">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">runtime.GOMAXPROCS</span> <span class="o">=</span> <span class="n">NCPU</span>
    <span class="nf">DoAll</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="1414-parallelizing-a-computation-over-a-large-amount-of-data">14.14 Parallelizing a computation over a large amount of data<a class="headerlink" href="#1414-parallelizing-a-computation-over-a-large-amount-of-data" title="Permanent link">&para;</a></h2>
<p>a number of steps: Preprocess / StepA / StepB / &hellip; / PostProcess</p>
<p>pipelining algorithm:</p>
<div class="codehilite"><pre><span></span><code><span class="n">func</span> <span class="nf">SerialProcessData</span><span class="p">(</span><span class="n">in</span> <span class="o">&lt;-</span> <span class="n">chan</span> <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">chan</span> <span class="o">*</span><span class="n">Data</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">for</span> <span class="n">data</span> <span class="o">:=</span> <span class="n">range</span> <span class="n">in</span> <span class="p">{</span>
        <span class="n">tmpA</span> <span class="o">:=</span> <span class="nf">PreprocessData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">tmpB</span> <span class="o">:=</span> <span class="nf">ProcessStepA</span><span class="p">(</span><span class="n">tmpA</span><span class="p">)</span>
        <span class="n">tmpC</span> <span class="o">:=</span> <span class="nf">ProcessStepA</span><span class="p">(</span><span class="n">tmpB</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">&lt;-</span> <span class="nf">PostProcess</span><span class="p">(</span><span class="n">tmpC</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">func</span> <span class="nf">ParallelProcessData</span><span class="p">(</span><span class="n">in</span> <span class="o">&lt;-</span> <span class="n">chan</span>  <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">chan</span> <span class="o">*</span><span class="n">Data</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">make</span> <span class="n">channels</span><span class="o">:</span>
    <span class="n">preOut</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
    <span class="n">stepAOut</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
    <span class="n">stepBOut</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
    <span class="n">stepCOut</span> <span class="o">:=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
    <span class="o">//</span> <span class="n">start</span> <span class="n">parallel</span> <span class="n">computations</span>
    <span class="n">go</span> <span class="nf">PreprocessData</span><span class="p">(</span><span class="n">in</span><span class="p">,</span> <span class="n">preOut</span><span class="p">)</span>
    <span class="n">go</span> <span class="nf">ProcessStepA</span><span class="p">(</span><span class="n">preOut</span><span class="p">,</span> <span class="n">stepAOut</span><span class="p">)</span>
    <span class="n">go</span> <span class="nf">ProcessStepB</span><span class="p">(</span><span class="n">stepAOut</span><span class="p">,</span> <span class="n">stepBOut</span><span class="p">)</span>
    <span class="n">go</span> <span class="nf">ProcessStepC</span><span class="p">(</span><span class="n">stepBOut</span><span class="p">,</span> <span class="n">stepCOut</span><span class="p">)</span>
    <span class="n">go</span> <span class="nf">PostProcessData</span><span class="p">(</span><span class="n">stepOut</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="1415-the-leaky-bucket-algorithm">14.15 The leaky bucket algorithm<a class="headerlink" href="#1415-the-leaky-bucket-algorithm" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="n">var</span> <span class="n">freeList</span> <span class="o">=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="o">*</span><span class="n">Buffer</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
<span class="n">var</span> <span class="n">serverChan</span> <span class="o">=</span> <span class="nf">make</span><span class="p">(</span><span class="n">chan</span> <span class="o">*</span><span class="n">Buffer</span><span class="p">)</span>

<span class="n">func</span> <span class="nf">client</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">for</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">b</span> <span class="o">*</span><span class="n">Buffer</span>
        <span class="n">select</span> <span class="p">{</span>
        <span class="n">case</span> <span class="n">b</span> <span class="o">=</span> <span class="o">&lt;-</span><span class="n">freeList</span><span class="o">:</span>
            <span class="o">//</span> <span class="n">Got</span> <span class="n">one</span><span class="p">;</span> <span class="n">nothing</span> <span class="n">more</span> <span class="n">todo</span>
        <span class="n">default</span><span class="o">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nf">new</span><span class="p">(</span><span class="n">Buffer</span><span class="p">)</span>
            <span class="nf">loadInto</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">//</span> <span class="n">read</span> <span class="n">next</span> <span class="n">message</span> <span class="n">from</span> <span class="n">the</span> <span class="n">network</span>
        <span class="p">}</span>
        <span class="n">serverChan</span> <span class="o">&lt;-</span> <span class="n">b</span> <span class="o">//</span><span class="n">send</span> <span class="n">to</span> <span class="n">server</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">func</span> <span class="nf">server</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">for</span>  <span class="p">{</span>
        <span class="n">b</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="n">serverChan</span> <span class="o">//</span> <span class="n">wait</span> <span class="n">for</span> <span class="n">work</span>
        <span class="nf">process</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="o">//</span> <span class="n">reuse</span> <span class="n">buffer</span> <span class="n">is</span> <span class="n">threre</span><span class="s">&#39;s room</span>
<span class="s">        select {</span>
<span class="s">        case freeList &lt;- b:</span>
<span class="s">            // Reuse buffer if free slot on freeList; nothing more to do</span>
<span class="s">        default:</span>
<span class="s">            // freeList is full, just carry on : the buffer is &#39;</span><span class="n">dropped</span><span class="s">&#39;</span>
<span class="s">            // doesn&#39;</span><span class="n">t</span> <span class="n">work</span> <span class="n">when</span> <span class="n">freeList</span> <span class="n">is</span> <span class="n">full</span><span class="p">,</span> <span class="n">leaky</span> <span class="n">bucket</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<h2 id="1416-benchmarking-goroutines">14.16 Benchmarking goroutines<a class="headerlink" href="#1416-benchmarking-goroutines" title="Permanent link">&para;</a></h2>
<h2 id="1417-concurrent-access-to-object-using-a-chnnel">14.17 Concurrent access to object using a chnnel<a class="headerlink" href="#1417-concurrent-access-to-object-using-a-chnnel" title="Permanent link">&para;</a></h2>
<p>To safeguard concurrent modifications of an object instead of using locking with a sync Mutex,
we can also use a backend goroutine for the sequential execution of anonymous functions.</p>
<h1 id="16-common-go-pitfalls-or-mistakes">16 Common Go Pitfalls or Mistakes<a class="headerlink" href="#16-common-go-pitfalls-or-mistakes" title="Permanent link">&para;</a></h1>
<h2 id="161-hidingshadowing-a-variable-by-misusing-short-declaration">16.1 Hiding(shadowing) a variable by misusing short declaration<a class="headerlink" href="#161-hidingshadowing-a-variable-by-misusing-short-declaration" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="n">var</span> <span class="n">remeber</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">false</span>
<span class="k">if</span> <span class="n">somehting</span> <span class="err">{</span>
    <span class="n">remeber</span> <span class="p">:</span><span class="o">=</span> <span class="k">true</span> <span class="o">//</span> <span class="n">use</span> <span class="o">=</span> <span class="k">not</span> <span class="p">:</span><span class="o">=</span>
<span class="err">}</span>
<span class="o">//</span> <span class="n">use</span> <span class="n">member</span>


<span class="n">func</span> <span class="n">shadow</span><span class="p">()</span> <span class="p">(</span><span class="n">err</span> <span class="n">error</span><span class="p">)</span> <span class="err">{</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span><span class="o">=</span> <span class="n">check1</span><span class="p">()</span> <span class="o">//</span> <span class="n">x</span> <span class="k">is</span> <span class="n">created</span><span class="p">,</span> <span class="n">err</span> <span class="k">is</span> <span class="n">assigned</span> <span class="k">to</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="err">{</span>
        <span class="k">return</span>   <span class="o">//</span> <span class="n">err</span> <span class="n">correctly</span> <span class="n">returned</span>
    <span class="err">}</span>
    <span class="k">if</span> <span class="n">y</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span><span class="o">=</span> <span class="n">check2</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span><span class="n">nil</span> <span class="err">{</span> <span class="o">//</span><span class="n">y</span> <span class="k">and</span> <span class="k">inner</span> <span class="n">err</span> <span class="k">are</span> <span class="n">created</span>
        <span class="k">return</span> <span class="o">//</span> <span class="k">inner</span> <span class="n">err</span> <span class="n">shadows</span> <span class="n">err</span> <span class="n">so</span> <span class="n">nil</span> <span class="k">is</span> <span class="n">wrongly</span> <span class="n">returned</span><span class="o">!</span>
    <span class="err">}</span> <span class="k">else</span> <span class="err">{</span>
        <span class="n">fmt</span><span class="p">.</span><span class="n">Println</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="err">}</span>
    <span class="k">return</span>
<span class="err">}</span>
</code></pre></div>


<h2 id="162-misusing-strings">16.2 Misusing strings<a class="headerlink" href="#162-misusing-strings" title="Permanent link">&para;</a></h2>
<p>mind that strings in go(like java and python) are immutable, Do not use a + b in a for loop,
intead one should use a bytes.Buffer to accumulate string content.</p>
<div class="codehilite"><pre><span></span><code><span class="err">func shadow() (err error) {</span>
<span class="err">    x, err := check1() // x is created, err is assigned to</span>
<span class="err">    if err != nil {</span>
<span class="err">        return   // err correctly returned</span>
<span class="err">    }</span>
<span class="err">    if y, err := check2(x); err !=nil { //y and inner err are created</span>
<span class="err">        return // inner err shadows err so nil is wrongly returned!</span>
<span class="err">    } else {</span>
<span class="err">        fmt.Println(y)</span>
<span class="err">    }</span>
<span class="err">    return</span>
<span class="err">}</span>
</code></pre></div>


<h2 id="163-using-defer-for-closing-a-file-in-the-wrong-scope">16.3 Using defer for closing a file in the wrong scope<a class="headerlink" href="#163-using-defer-for-closing-a-file-in-the-wrong-scope" title="Permanent link">&para;</a></h2>
<p>Defer is only executed at the return of a function, not at the end of a loop or some other limited scope.</p>
<h2 id="164-confusing-new-and-make">16.4 Confusing new() and make()<a class="headerlink" href="#164-confusing-new-and-make" title="Permanent link">&para;</a></h2>
<ul>
<li>for slices, maps and channels, use make</li>
<li>for arrays, structs and all value types: use new</li>
</ul>
<h2 id="165-no-need-to-pass-a-pointer-to-a-slice-to-a-function">16.5 No need to pass a pointer to a slice to a function<a class="headerlink" href="#165-no-need-to-pass-a-pointer-to-a-slice-to-a-function" title="Permanent link">&para;</a></h2>
<h2 id="166-using-pointers-to-interface-types">16.6 Using pointers to interface types<a class="headerlink" href="#166-using-pointers-to-interface-types" title="Permanent link">&para;</a></h2>
<p>Never use a pointer to an interface type, this is already a pointer!</p>
<h2 id="167-misusing-pointers-wiht-value-types">16.7 Misusing pointers wiht value types<a class="headerlink" href="#167-misusing-pointers-wiht-value-types" title="Permanent link">&para;</a></h2>
<h2 id="168-misusing-goroutines-and-channels">16.8 Misusing goroutines and channels<a class="headerlink" href="#168-misusing-goroutines-and-channels" title="Permanent link">&para;</a></h2>
<p>Only using goroutines and channels only where concurrency is important!</p>
<h2 id="169-using-closures-with-goroutines">16.9 Using closures with goroutines<a class="headerlink" href="#169-using-closures-with-goroutines" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;fmt&quot;</span>
    <span class="s2">&quot;time&quot;</span>
<span class="p">)</span>

<span class="n">var</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="nb">int</span><span class="p">{</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">}</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">version</span> <span class="n">A</span>
    <span class="k">for</span> <span class="n">ix</span> <span class="p">:</span><span class="o">=</span> <span class="nb">range</span> <span class="n">values</span> <span class="p">{</span>
        <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="p">}()</span>
    <span class="p">}</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">()</span>   <span class="o">//</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span>

    <span class="o">//</span> <span class="n">version</span> <span class="n">B</span>
    <span class="k">for</span> <span class="n">ix</span> <span class="p">:</span><span class="o">=</span> <span class="nb">range</span> <span class="n">values</span> <span class="p">{</span>
        <span class="n">go</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>  <span class="o">//</span> <span class="n">invoke</span> <span class="n">each</span> <span class="n">closure</span> <span class="k">as</span> <span class="n">a</span> <span class="n">goroutine</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="p">}()</span> <span class="o">//</span> <span class="n">the</span> <span class="n">goroutine</span> <span class="n">will</span> <span class="n">probably</span> <span class="ow">not</span> <span class="n">begin</span> <span class="n">executing</span> <span class="n">until</span> <span class="n">after</span> <span class="n">the</span> <span class="n">loop</span>
    <span class="p">}</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">()</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span>
    <span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="mf">5e9</span><span class="p">)</span>
    <span class="o">//</span> <span class="n">Version</span> <span class="n">C</span><span class="p">:</span> <span class="n">the</span> <span class="n">right</span> <span class="n">way</span>
    <span class="k">for</span> <span class="n">ix</span> <span class="p">:</span><span class="o">=</span> <span class="nb">range</span> <span class="n">values</span> <span class="p">{</span>
        <span class="n">go</span> <span class="n">func</span><span class="p">(</span><span class="n">ix</span> <span class="n">interface</span><span class="p">{})</span> <span class="p">{</span> <span class="o">//</span> <span class="n">invoke</span> <span class="n">each</span> <span class="n">closure</span> <span class="k">with</span> <span class="n">ix</span> <span class="k">as</span> <span class="n">a</span> <span class="n">parameter</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">//</span><span class="n">ix</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">evaluated</span> <span class="n">at</span> <span class="n">each</span> <span class="n">iteration</span> <span class="ow">and</span> <span class="n">placed</span> <span class="n">on</span> <span class="n">the</span> <span class="n">stack</span> <span class="n">of</span> <span class="n">goroutine</span>
        <span class="p">}(</span><span class="n">ix</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">()</span>  <span class="o">//</span> <span class="n">random</span>
    <span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="mf">5e9</span><span class="p">)</span>
    <span class="o">//</span> <span class="n">Version</span> <span class="n">D</span><span class="p">:</span> <span class="k">print</span> <span class="n">out</span> <span class="n">values</span>
    <span class="k">for</span> <span class="n">ix</span> <span class="p">:</span><span class="o">=</span> <span class="nb">range</span> <span class="n">values</span> <span class="p">{</span>
        <span class="n">val</span> <span class="p">:</span><span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">//</span> <span class="n">variables</span> <span class="n">declared</span> <span class="n">witin</span> <span class="n">the</span> <span class="n">body</span> <span class="n">of</span> <span class="n">a</span> <span class="n">loop</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">shared</span> <span class="n">between</span> <span class="n">iterations</span>
        <span class="n">go</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="p">}()</span>
    <span class="p">}</span>
    <span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span> <span class="o">//</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="1610-bad-error-handling">16.10 Bad error handling<a class="headerlink" href="#1610-bad-error-handling" title="Permanent link">&para;</a></h2>
<p>wrap your error conditions in a closure wherever possible, like in the following example.</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">seperate</span> <span class="n">error</span> <span class="n">checking</span><span class="p">,</span> <span class="n">error</span> <span class="n">reporting</span><span class="p">,</span> <span class="k">and</span> <span class="n">normal</span> <span class="n">program</span> <span class="n">logic</span>

<span class="n">func</span> <span class="n">httpRequestHandler</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">req</span> <span class="o">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="err">{</span>
    <span class="n">err</span> <span class="p">:</span><span class="o">=</span> <span class="n">func</span><span class="p">()</span> <span class="n">error</span> <span class="err">{</span>
        <span class="k">if</span> <span class="n">req</span><span class="p">.</span><span class="k">Method</span> <span class="o">!=</span> <span class="ss">&quot;GET&quot;</span><span class="err">{</span>
            <span class="k">return</span> <span class="n">errors</span><span class="p">.</span><span class="k">New</span><span class="p">(</span><span class="ss">&quot;expected GET&quot;</span><span class="p">)</span>
        <span class="err">}</span>
        <span class="k">if</span> <span class="k">input</span> <span class="p">:</span><span class="o">=</span> <span class="n">paraseInput</span><span class="p">(</span><span class="n">req</span><span class="p">);</span> <span class="k">input</span> <span class="o">!=</span> <span class="ss">&quot;command&quot;</span> <span class="err">{</span>
            <span class="k">return</span> <span class="n">errors</span><span class="p">.</span><span class="k">New</span><span class="p">(</span><span class="ss">&quot;malformed command&quot;</span><span class="p">)</span>
        <span class="err">}</span>
    <span class="err">}</span><span class="p">()</span>
    <span class="o">//</span> <span class="n">other</span> <span class="n">error</span> <span class="n">conditions</span> <span class="n">can</span> <span class="n">be</span> <span class="n">tested</span> <span class="n">here</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="err">{</span>
        <span class="n">w</span><span class="p">.</span><span class="n">WriteHeader</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">WriterString</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="err">}</span>
    <span class="n">doSomething</span><span class="p">()</span> <span class="o">//</span>
<span class="err">}</span>
</code></pre></div>


<h1 id="17-go-language-patterns">17 Go Language Patterns<a class="headerlink" href="#17-go-language-patterns" title="Permanent link">&para;</a></h1>
<h2 id="171-the-comma-ok-pattern">17.1 The comma, ok pattern<a class="headerlink" href="#171-the-comma-ok-pattern" title="Permanent link">&para;</a></h2>
<h2 id="172-the-defer-pattern">17.2 The defer pattern<a class="headerlink" href="#172-the-defer-pattern" title="Permanent link">&para;</a></h2>
<h2 id="173-the-visibility-pattern">17.3 The visibility pattern<a class="headerlink" href="#173-the-visibility-pattern" title="Permanent link">&para;</a></h2>
<h2 id="174-the-operator-pattern-and-interface">17.4 The operator pattern and interface<a class="headerlink" href="#174-the-operator-pattern-and-interface" title="Permanent link">&para;</a></h2>
<p>go不支持操作符重载，可以使用函数/方法/接口 来模拟。</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../advanced-go-programming-book/advanced-go-programming/" class="btn btn-neutral float-right" title="advanced-go-programming">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../go%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B/" class="btn btn-neutral" title="go语言编程"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/zwiley/mybook/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../go%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../advanced-go-programming-book/advanced-go-programming/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
